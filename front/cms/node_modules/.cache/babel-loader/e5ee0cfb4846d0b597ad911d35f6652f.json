{"remainingRequest":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/babel-loader/lib/index.js!/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/eslint-loader/index.js??ref--13-0!/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/src/config/myAxios.js","dependencies":[{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/src/config/myAxios.js","mtime":1641641123786},{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBzdG9yZSBmcm9tICdAL3N0b3JlJzsKaW1wb3J0IHsgc2hvd0xvZ2luQWxlcnQgfSBmcm9tICJAL3V0aWxzL3NuYWNrYmFyLmpzIjsKaW1wb3J0IHsgRGVib3VuY2UgfSBmcm9tICJAL3V0aWxzL3Rvb2xzLmpzIjsKaW1wb3J0IHsgcmVmcmVzaFRpY2tldElmTmVlZCB9IGZyb20gIkAvYXBpL2dldERhdGEuanMiOwppbXBvcnQgeyBpc051bGwgfSBmcm9tICJAL3V0aWxzL2NvbW1vbi5qcyI7IC8vaW1wb3J0IHtiYXNlVXJsfSBmcm9tICcuL2Vudic7Ci8vICDorqnor7fmsYLlnKjmtY/op4jlmajkuK3lhYHorrjot6jln5/mkLrluKZjb29raWUKLy9heGlvcy5kZWZhdWx0cy53aXRoQ3JlZGVudGlhbHMgPSB0cnVlOwovLyBheGlvcy5kZWZhdWx0cy5wb3N0WydDb250ZW50LXR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uJyAvLyDor7fmsYLlpLTlr7nlupTmlbDmja7moLzlvI8KCnZhciBpbnN0YW5jZSA9IGF4aW9zLmNyZWF0ZSh7CiAgLy8gYmFzZVVybAogIGJhc2VVUkw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEksCiAgLy8g6LaF5pe2CiAgdGltZW91dDogMjAwMDAKfSk7IC8vIC8v6K+35rGC5oum5oiqCi8vIGluc3RhbmNlLmludGVyY2VwdG9ycy5yZXF1ZXN0LnVzZSggY29uZmlnPT57Ci8vICAgICBjb25zb2xlLmxvZyhjb25maWcpCi8vICAgICAvL+WkhOeQhnRva2VuCi8vICAgICAvLyAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKSB7Ci8vICAgIC8vICAgICBjb25maWcuaGVhZGVycy5BQ0NFU1NfVE9LRU4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKTsKLy8gICAgLy8gIH0KLy8gICAgIHJldHVybiBjb25maWc7Ci8vIH0sZXJyb3I9PnsKLy8gICAgIC8v5a+56K+35rGC6ZSZ6K+v5YGa5Lqb5LuA5LmICi8vICAgIGNvbnNvbGUubG9nKGVycm9yKTsKLy8gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7Ci8vIH0pOwoKaW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlcXVlc3QudXNlKGZ1bmN0aW9uIChjb25maWcpIHsKICBjb25zb2xlLmRlYnVnKCfor7fmsYLlj4LmlbDvvJonLCBjb25maWcpOwogIGNvbnNvbGUubG9nKCIjIyMjIHJlcXVlc3QgdXJsIGlzICMjIyMjICIgKyBjb25maWcudXJsKTsgLy/lpoLmnpzmmK9yZWZyZXNo6K+35rGC77yM5oiR5Lus5bCx5LiN6KaB5oum5oiq6Kem5Y+R5Yi35pawdG9rZW7kuobvvIzov5nmoLfkvJrlr7zoh7TliLfkuKTmrKHjgIIKCiAgaWYgKCJ0aWNrZXQvcmVmcmVzaCIgIT09IGNvbmZpZy51cmwpIHsKICAgIHJlZnJlc2hUaWNrZXQoKTsKICB9CgogIHJldHVybiBjb25maWc7Cn0sIGZ1bmN0aW9uIChlcnJvcikgewogIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7Cn0pOyAvL+i/lOWbnuaLpuaIqgoKaW5zdGFuY2UuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAvLyAyMDDmraPnoa7vvIzov5Tlm57nu5PmnpwgCiAgY29uc29sZS5kZWJ1ZyhyZXNwb25zZS5kYXRhKTsKICBjb25zb2xlLmRlYnVnKCLor7fmsYLnu5Pmnpw6XG4iICsgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpOwogIGNvbnNvbGUuZGVidWcoIm9uIHJlc3BvbnNlIHVybCA9PT0+IFtbIiArIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmNvbmZpZy51cmwpICsgIl0gc2VydmVyIGhlYWRlcnMgPT0+ICIgKyBKU09OLnN0cmluZ2lmeShyZXNwb25zZS5oZWFkZXJzKSk7CiAgY29uc29sZS5kZWJ1Zygib24gcmVzcG9uc2UgdXJsID09PT4gW1siICsgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuY29uZmlnLnVybCkgKyAiXSBzZXJ2ZXIgdGlja2V0ID09PiAiICsgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuaGVhZGVyc1sndGlja2V0J10pKTsKICBjb25zb2xlLmRlYnVnKCJvbiByZXNwb25zZSB1cmwgPT09PiBbWyIgKyBKU09OLnN0cmluZ2lmeShyZXNwb25zZS5jb25maWcudXJsKSArICJdIHNlcnZlciBleHBfdGltZSA9PT4gIiArIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmhlYWRlcnNbJ3RpY2tldF9leHAnXSkpOwogIGNvbnNvbGUuZGVidWcoIiMjIG9uIHNlcnZlciByZXNwb25zZSAjIyAiLCByZXNwb25zZS5jb25maWcpOwoKICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgIC8v5a2Y5pyN5Yqh5Zmo55qEdGlja2V0CiAgICB2YXIgdGlja2V0ID0gcmVzcG9uc2UuaGVhZGVycy50aWNrZXQ7CgogICAgaWYgKHR5cGVvZiB0aWNrZXQgIT09ICJ1bmRlZmluZWQiICYmIHRpY2tldCAhPT0gbnVsbCAmJiB0aWNrZXQgIT09ICIiKSB7CiAgICAgIHN0b3JlLmNvbW1pdCgidXNlci9zZXRUaWNrZXQiLCB0aWNrZXQpOwogICAgfSAvL+WtmOacjeWKoeWZqOe7meeahHRpY2tldOeahOi/h+acn+aXtumXtAoKCiAgICB2YXIgZXhwVGltZSA9IHJlc3BvbnNlLmhlYWRlcnMudGlja2V0X2V4cDsKCiAgICBpZiAodHlwZW9mIGV4cFRpbWUgIT09ICJ1bmRlZmluZWQiICYmIGV4cFRpbWUgIT09IG51bGwgJiYgZXhwVGltZSAhPT0gIiIpIHsKICAgICAgc3RvcmUuY29tbWl0KCJ1c2VyL3NldFRpY2tldEV4cGlyZVRpbWUiLCBleHBUaW1lKTsKICAgIH0KCiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlLmRhdGEpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzcG9uc2UpOwogIH0KfSwgZnVuY3Rpb24gKGVycm9yKSB7CiAgLy/otoXml7blpITnkIYgIAogIHZhciBtZXNzYWdlID0gZXJyb3IubWVzc2FnZTsKICBjb25zb2xlLmRlYnVnKCI9PT09PXJlcXVlc3QgZXJyb3I9PT4iICsgSlNPTi5zdHJpbmdpZnkoZXJyb3IucmVzcG9uc2UpKTsKCiAgaWYgKGF4aW9zLmlzQ2FuY2VsKGVycm9yKSkgewogICAgY29uc29sZS5sb2coIueUqOaIt+WPlua2iOe9kee7nOivt+axgiIpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKGVycm9yLmNvZGUgPT09ICdFQ09OTkFCT1JURUQnICYmIG1lc3NhZ2UuaW5kZXhPZigndGltZW91dCcpID4gLTEpIHsKICAgIGNvbnNvbGUuZXJyb3IoIuivt+axgui2heaXtu+8geivt+ajgOafpee9kee7nOmXrumimCIpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKDQwMCA8PSBlcnJvci5yZXNwb25zZS5zdGF0dXMgPCA1MDApIHsKICAgIHZhciBjb2RlID0gZXJyb3IucmVzcG9uc2UuZGF0YS5jb2RlOwogICAgY29uc29sZS5lcnJvcigi5pyN5Yqh5Zmo6ZSZ6K+v77yMY29kZSDvvJoiICsgZXJyb3IucmVzcG9uc2Uuc3RhdHVzKTsKICAgIGNvbnNvbGUuZXJyb3IoIuS4muWKoemUmeivr++8jGNvZGUg77yaIiArIGNvZGUpOwogICAgY29uc29sZS5lcnJvcigib24gZXJyb3IgPT09PT09PT4gIiArIEpTT04uc3RyaW5naWZ5KGVycm9yLnJlc3BvbnNlLmhlYWRlcnMpKTsKICAgIHZhciB0aWNrZXQgPSBlcnJvci5yZXNwb25zZS5oZWFkZXJzLnRpY2tldDsKCiAgICBpZiAodHlwZW9mIHRpY2tldCAhPT0gInVuZGVmaW5lZCIgJiYgdGlja2V0ICE9PSBudWxsICYmIHRpY2tldCAhPT0gIiIpIHsKICAgICAgc3RvcmUuY29tbWl0KCJ1c2VyL3NldFRpY2tldCIsIHRpY2tldCk7CiAgICB9CgogICAgaWYgKGNvZGUgPT09IDMwMDcgfHwgY29kZSA9PT0gNDAwMiB8fCBjb2RlID09PSAzMDA1IHx8IGNvZGUgPT09IDQxIHx8IGNvZGUgPT09IDQwKSB7CiAgICAgIGNvbnNvbGUubG9nKCI9PT0+IG9uIHRva2VuIGV4cGlyZSA8PT09ICIpOwogICAgICBzaG93TG9naW5BbGVydCgpOwogICAgfQoKICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgfSBlbHNlIHsKICAgIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPj0gNTAwKSB7CiAgICAgIGNvbnNvbGUuZGVidWcoIuacjeWKoeWZqOmUmeivr++8jGNvZGUg77yaICIgKyBlcnJvci5yZXNwb25zZS5zdGF0dXMpOwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS5kZWJ1Zygi5pyN5Yqh5Zmo6ZSZ6K+v77yMY29kZSDvvJogIiArIGVycm9yLnJlc3BvbnNlLnN0YXR1cyk7CiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7CiAgICB9CiAgfQp9KTsKZXhwb3J0IGRlZmF1bHQgaW5zdGFuY2U7CnZhciByZWZyZXNoVGlja2V0ID0gRGVib3VuY2UoZnVuY3Rpb24gKCkgewogIHZhciBleHBpcmVUaW1lID0gc3RvcmUuc3RhdGUudXNlci5leHBpcmVUaW1lOwoKICBpZiAodHlwZW9mIGV4cGlyZVRpbWUgPT09ICd1bmRlZmluZWQnIHx8IGV4cGlyZVRpbWUgPT09IG51bGwgfHwgZXhwaXJlVGltZSA9PT0gMCB8fCBleHBpcmVUaW1lID09PSAiIikgewogICAgY29uc29sZS5sb2coIltbW1t0aGUgZXhwaXJlIHRpbWUgaXMgbnVsbF1dXV0iKTsKICAgIHJldHVybjsKICB9IC8v5Ymp5L2ZMTDliIbpkp/ov4fmnJ/nmoTml7blgJnvvIzliLfmlrB0aWNrZXQKCgogIGlmIChleHBpcmVUaW1lIDw9IDEwMDAgKiA2MCAqIDEwKSB7CiAgICBjb25zb2xlLmxvZygid2UgbmVlZCByZWZyZXNoIHRoZSB0aWNrZXQgZXhwaXJlIHRpbWUgPT09PT4gWyIgKyBleHBpcmVUaW1lICsgIl0iKTsKICAgIHJlZnJlc2hUaWNrZXRJZk5lZWQoKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgIGlmIChpc051bGwocmVzcCkgfHwgcmVzcC5jb2RlICE9IDAgfHwgaXNOdWxsKHJlc3AuZGF0YSkpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCJbW1tyZWZyZXNoXV1dIGVycm9yXV1dIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdGlja2V0ID0gcmVzcC5kYXRhLnZhbHVlOwoKICAgICAgaWYgKHR5cGVvZiB0aWNrZXQgIT09ICJ1bmRlZmluZWQiICYmIHRpY2tldCAhPT0gbnVsbCAmJiB0aWNrZXQgIT09ICIiKSB7CiAgICAgICAgY29uc29sZS5sb2coIltbW1sgcmVmcmVzaCB0aWNrZXQgaXMgPT09PT4gW1tbWyIgKyB0aWNrZXQgKyAiXV1dXV0iKTsKICAgICAgICBzdG9yZS5jb21taXQoInVzZXIvc2V0VGlja2V0IiwgdGlja2V0KTsKICAgICAgfQogICAgfSk7CiAgfSBlbHNlIHsKICAgIGNvbnNvbGUubG9nKCJbW1tbVGhlIHJlZnJlc2ggdGltZSBlbm91Z2guIGlnbm9yZSBpdCA9PT4gWyIgKyBleHBpcmVUaW1lICsgIl1dXV1dIik7CiAgfQp9LCA1MDAwKTs="},{"version":3,"sources":["/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/src/config/myAxios.js"],"names":["axios","store","showLoginAlert","Debounce","refreshTicketIfNeed","isNull","instance","create","baseURL","process","env","VUE_APP_BASE_API","timeout","interceptors","request","use","config","console","debug","log","url","refreshTicket","error","Promise","reject","response","data","JSON","stringify","headers","status","ticket","commit","expTime","ticket_exp","resolve","message","isCancel","code","indexOf","expireTime","state","user","then","resp","value"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport store from '@/store';\nimport { showLoginAlert } from \"@/utils/snackbar.js\";\nimport { Debounce } from \"@/utils/tools.js\";\nimport { refreshTicketIfNeed} from \"@/api/getData.js\"\nimport { isNull} from \"@/utils/common.js\"\n\n//import {baseUrl} from './env';\n\n//  让请求在浏览器中允许跨域携带cookie\n//axios.defaults.withCredentials = true;\n// axios.defaults.post['Content-type'] = 'application/json' // 请求头对应数据格式\n\n\nconst instance = axios.create({\n    // baseUrl\n    baseURL: process.env.VUE_APP_BASE_API,\n    // 超时\n    timeout: 20000,\n\n})\n// //请求拦截\n// instance.interceptors.request.use( config=>{\n//     console.log(config)\n//     //处理token\n//     //  if (localStorage.getItem('token')) {\n//    //     config.headers.ACCESS_TOKEN = localStorage.getItem('token');\n//    //  }\n//     return config;\n// },error=>{\n//     //对请求错误做些什么\n//    console.log(error);\n//    return Promise.reject();\n// });\n\ninstance.interceptors.request.use(function (config) {\n    console.debug('请求参数：', config);\n    console.log(\"#### request url is ##### \"+config.url)\n    //如果是refresh请求，我们就不要拦截触发刷新token了，这样会导致刷两次。\n    if(\"ticket/refresh\" !== config.url) {\n        refreshTicket()\n    }\n    return config;\n}, error => {\n    return Promise.reject(error);\n});\n\n//返回拦截\ninstance.interceptors.response.use(response => {\n    // 200正确，返回结果 \n    console.debug(response.data)\n    console.debug(\"请求结果:\\n\"+JSON.stringify(response.data));\n    console.debug(\"on response url ===> [[\"+JSON.stringify(response.config.url)+\"] server headers ==> \"+JSON.stringify(response.headers))\n    console.debug(\"on response url ===> [[\"+JSON.stringify(response.config.url)+\"] server ticket ==> \"+JSON.stringify(response.headers['ticket']))\n    console.debug(\"on response url ===> [[\"+JSON.stringify(response.config.url)+\"] server exp_time ==> \"+JSON.stringify(response.headers['ticket_exp']))\n    console.debug(\"## on server response ## \",response.config)\n    if (response.status === 200) {\n        //存服务器的ticket\n        let ticket = response.headers.ticket;\n        if(typeof ticket !== \"undefined\" && ticket !== null && ticket !== \"\") {\n            store.commit(\"user/setTicket\",ticket);\n        }\n        //存服务器给的ticket的过期时间\n        let expTime = response.headers.ticket_exp;\n        if(typeof expTime !== \"undefined\" && expTime !== null && expTime !== \"\") {\n            store.commit(\"user/setTicketExpireTime\",expTime);\n        }\n        return Promise.resolve(response.data);\n    } else {\n        return Promise.reject(response);\n    }\n}, error => {\n    //超时处理  \n    const { message } = error;\n    console.debug(\"=====request error==>\"+JSON.stringify(error.response))\n    if(axios.isCancel(error)){\n        console.log(\"用户取消网络请求\");\n        return;\n    }\n    if (error.code === 'ECONNABORTED' && message.indexOf('timeout') > -1) {\n        console.error(\"请求超时！请检查网络问题\");\n        return;\n    }\n\n    if (\n        400 <= error.response.status < 500\n    ) {\n        let code = error.response.data.code;\n        console.error(\"服务器错误，code ：\" + error.response.status);\n        console.error(\"业务错误，code ：\" + code);\n        console.error(\"on error =======> \"+JSON.stringify(error.response.headers))\n       \n        let ticket = error.response.headers.ticket;\n        if(typeof ticket !== \"undefined\" && ticket !== null && ticket !== \"\") {\n            store.commit(\"user/setTicket\",ticket);\n        }\n\n        if(code === 3007 || code === 4002 || code === 3005 || code === 41 || code === 40) {\n            console.log(\"===> on token expire <=== \")\n            showLoginAlert()\n        } \n        return Promise.reject(error)\n      \n    } else {\n        if (error.response.status >= 500) {\n            console.debug(\"服务器错误，code ： \" + error.response.status);\n        } else {\n            console.debug(\"服务器错误，code ： \" + error.response.status);\n            return Promise.reject(error)\n        }\n    }\n});\n\nexport default instance;\n\n\nconst refreshTicket = Debounce(function () {\n    let expireTime = store.state.user.expireTime\n    if(typeof expireTime === 'undefined' || expireTime === null || expireTime === 0 || expireTime === \"\") {\n        console.log(\"[[[[the expire time is null]]]]\")   \n        return;\n    }\n    //剩余10分钟过期的时候，刷新ticket\n    if(expireTime <= 1000 * 60 * 10) {\n        console.log(\"we need refresh the ticket expire time ====> [\"+expireTime+\"]\")   \n        refreshTicketIfNeed().then((resp) => {\n            if(isNull(resp) || resp.code != 0 || isNull(resp.data)) {\n                console.error(\"[[[refresh]]] error]]]\")\n                return;\n            }\n            let ticket = resp.data.value\n            if(typeof ticket !== \"undefined\" && ticket !== null && ticket !== \"\") {\n                console.log(\"[[[[ refresh ticket is ====> [[[[\"+ticket+\"]]]]]\") \n                store.commit(\"user/setTicket\",ticket); \n            }\n        })\n    }else {\n     console.log(\"[[[[The refresh time enough. ignore it ==> [\"+expireTime+\"]]]]]\")   \n    } \n  }, 5000)\n\n"]}]}
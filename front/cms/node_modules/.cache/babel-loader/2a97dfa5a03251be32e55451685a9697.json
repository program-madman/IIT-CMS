{"remainingRequest":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/babel-loader/lib/index.js!/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuguanghui/Documents/cms_code/my-message/cms/src/components/base/iframe-router-view.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/src/components/base/iframe-router-view.vue","mtime":1638103240516},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucmVwbGFjZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBWdWUgZnJvbSAidnVlL2Rpc3QvdnVlLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb21wb25lbnRzQXJyOiBbXQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDlrp7njrDmh5LliqDovb3vvIzlj6rmuLLmn5Plt7Lnu4/miZPlvIDov4fvvIhoYXNPcGVuOnRydWXvvInnmoRpZnJhbWXpobUKICAgIGhhc09wZW5Db21wb25lbnRzQXJyOiBmdW5jdGlvbiBoYXNPcGVuQ29tcG9uZW50c0FycigpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50c0Fyci5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5oYXNPcGVuOwogICAgICB9KTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAkcm91dGU6IGZ1bmN0aW9uICRyb3V0ZSgpIHsKICAgICAgLy8g5Yik5pat5b2T5YmN6Lev55Sx5piv5ZCmaWZyYW1l6aG1CiAgICAgIHRoaXMuaXNPcGVuSWZyYW1lUGFnZSgpOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIC8vIOiuvue9rmlmcmFtZemhteeahOaVsOe7hOWvueixoQogICAgdmFyIGNvbXBvbmVudHNBcnIgPSB0aGlzLmdldENvbXBvbmVudHNBcnIoKTsKICAgIGNvbXBvbmVudHNBcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICBWdWUuY29tcG9uZW50KGl0ZW0ubmFtZSwgaXRlbS5jb21wb25lbnQpOwogICAgfSk7CiAgICB0aGlzLmNvbXBvbmVudHNBcnIgPSBjb21wb25lbnRzQXJyOyAvLyDliKTmlq3lvZPliY3ot6/nlLHmmK/lkKZpZnJhbWXpobUKCiAgICB0aGlzLmlzT3BlbklmcmFtZVBhZ2UoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOagueaNruW9k+WJjei3r+eUseiuvue9rmhhc09wZW4KICAgIGlzT3BlbklmcmFtZVBhZ2U6IGZ1bmN0aW9uIGlzT3BlbklmcmFtZVBhZ2UoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5jb21wb25lbnRzQXJyLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5wYXRoID09PSBfdGhpcy4kcm91dGUucGF0aDsKICAgICAgfSk7CgogICAgICBpZiAodGFyZ2V0ICYmICF0YXJnZXQuaGFzT3BlbikgewogICAgICAgIHRhcmdldC5oYXNPcGVuID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICAgIC8vIOmBjeWOhui3r+eUseeahOaJgOaciemhtemdou+8jOaKiuWQq+aciWlmcmFtZUNvbXBvbmVudOagh+ivhueahOaUtumbhui1t+adpQogICAgZ2V0Q29tcG9uZW50c0FycjogZnVuY3Rpb24gZ2V0Q29tcG9uZW50c0FycigpIHsKICAgICAgdmFyIHJvdXRlciA9IHRoaXMuJHJvdXRlcjsKICAgICAgdmFyIHJvdXRlcyA9IHJvdXRlci5vcHRpb25zLnJvdXRlczsKICAgICAgdmFyIGNoaWxkcmVuID0gcm91dGVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmNoaWxkcmVuOwogICAgICB9KTsKICAgICAgdmFyIGlmcmFtZUFyciA9IGNoaWxkcmVuWzBdLmNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmlmcmFtZUNvbXBvbmVudDsKICAgICAgfSk7CiAgICAgIHJldHVybiBpZnJhbWVBcnIubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgdmFyIG5hbWUgPSBpdGVtLm5hbWUgfHwgaXRlbS5wYXRoLnJlcGxhY2UoIi8iLCAiIik7IC8vICAgICAgICAgY29uc29sZS5sb2coIi0tLS0tLS0tLS0tLS0tLS0+IitpdGVtLmlmcmFtZUNvbXBvbmVudCkKCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICBwYXRoOiBpdGVtLnBhdGgsCiAgICAgICAgICBoYXNPcGVuOiBmYWxzZSwKICAgICAgICAgIC8vIOaYr+WQpuaJk+W8gOi/h++8jOm7mOiupGZhbHNlCiAgICAgICAgICBjb21wb25lbnQ6IGl0ZW0uaWZyYW1lQ29tcG9uZW50IC8vIOe7hOS7tuaWh+S7tueahOW8leeUqAoKICAgICAgICB9OwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["iframe-router-view.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAoBA,OAAA,GAAA,MAAA,iBAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,aAAA,EAAA;AADA,KAAA;AAGA,GALA;AAMA,EAAA,QAAA,EAAA;AACA;AACA,IAAA,oBAFA,kCAEA;AACA,aAAA,KAAA,aAAA,CAAA,MAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,OAAA;AAAA,OAAA,CAAA;AACA;AAJA,GANA;AAYA,EAAA,KAAA,EAAA;AACA,IAAA,MADA,oBACA;AACA;AACA,WAAA,gBAAA;AACA;AAJA,GAZA;AAkBA,EAAA,OAlBA,qBAkBA;AACA;AACA,QAAA,aAAA,GAAA,KAAA,gBAAA,EAAA;AACA,IAAA,aAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,MAAA,GAAA,CAAA,SAAA,CAAA,IAAA,CAAA,IAAA,EAAA,IAAA,CAAA,SAAA;AACA,KAFA;AAGA,SAAA,aAAA,GAAA,aAAA,CANA,CAOA;;AACA,SAAA,gBAAA;AACA,GA3BA;AA4BA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,gBAFA,8BAEA;AAAA;;AACA,UAAA,MAAA,GAAA,KAAA,aAAA,CAAA,IAAA,CAAA,UAAA,IAAA,EAAA;AACA,eAAA,IAAA,CAAA,IAAA,KAAA,KAAA,CAAA,MAAA,CAAA,IAAA;AACA,OAFA,CAAA;;AAGA,UAAA,MAAA,IAAA,CAAA,MAAA,CAAA,OAAA,EAAA;AACA,QAAA,MAAA,CAAA,OAAA,GAAA,IAAA;AACA;AACA,KATA;AAUA;AACA,IAAA,gBAXA,8BAWA;AACA,UAAA,MAAA,GAAA,KAAA,OAAA;AACA,UAAA,MAAA,GAAA,MAAA,CAAA,OAAA,CAAA,MAAA;AACA,UAAA,QAAA,GAAA,MAAA,CAAA,MAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,QAAA;AAAA,OAAA,CAAA;AACA,UAAA,SAAA,GAAA,QAAA,CAAA,CAAA,CAAA,CAAA,QAAA,CAAA,MAAA,CACA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,eAAA;AAAA,OADA,CAAA;AAIA,aAAA,SAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,GAAA,IAAA,CAAA,IAAA,IAAA,IAAA,CAAA,IAAA,CAAA,OAAA,CAAA,GAAA,EAAA,EAAA,CAAA,CADA,CAEA;;AACA,eAAA;AACA,UAAA,IAAA,EAAA,IADA;AAEA,UAAA,IAAA,EAAA,IAAA,CAAA,IAFA;AAGA,UAAA,OAAA,EAAA,KAHA;AAGA;AACA,UAAA,SAAA,EAAA,IAAA,CAAA,eAJA,CAIA;;AAJA,SAAA;AAMA,OATA,CAAA;AAUA;AA7BA;AA5BA,CAAA","sourcesContent":["<template>\r\n  <div>\r\n    <!-- Vue的router-view -->\r\n    <keep-alive>\r\n      <router-view v-if=\"$route.meta.keepAlive\" />\r\n    </keep-alive>\r\n    <router-view v-if=\"!$route.meta.keepAlive\" />\r\n\r\n    <!-- iframe页 -->\r\n\r\n    <component\r\n      :is=\"item.component\"\r\n      v-for=\"item in hasOpenComponentsArr\"\r\n      v-show=\"$route.path === item.path\"\r\n      :key=\"item.name\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue/dist/vue.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      componentsArr: [],\r\n    };\r\n  },\r\n  computed: {\r\n    // 实现懒加载，只渲染已经打开过（hasOpen:true）的iframe页\r\n    hasOpenComponentsArr() {\r\n      return this.componentsArr.filter((item) => item.hasOpen);\r\n    },\r\n  },\r\n  watch: {\r\n    $route() {\r\n      // 判断当前路由是否iframe页\r\n      this.isOpenIframePage();\r\n    },\r\n  },\r\n  created() {\r\n    // 设置iframe页的数组对象\r\n    const componentsArr = this.getComponentsArr();\r\n    componentsArr.forEach((item) => {\r\n      Vue.component(item.name, item.component);\r\n    });\r\n    this.componentsArr = componentsArr;\r\n    // 判断当前路由是否iframe页\r\n    this.isOpenIframePage();\r\n  },\r\n  methods: {\r\n    // 根据当前路由设置hasOpen\r\n    isOpenIframePage() {\r\n      const target = this.componentsArr.find((item) => {\r\n        return item.path === this.$route.path;\r\n      });\r\n      if (target && !target.hasOpen) {\r\n        target.hasOpen = true;\r\n      }\r\n    },\r\n    // 遍历路由的所有页面，把含有iframeComponent标识的收集起来\r\n    getComponentsArr() {\r\n      const router = this.$router;\r\n      const routes = router.options.routes;\r\n      const children = routes.filter((item) => item.children);\r\n      const iframeArr = children[0].children.filter(\r\n        (item) => item.iframeComponent\r\n      );\r\n\r\n      return iframeArr.map((item) => {\r\n        const name = item.name || item.path.replace(\"/\", \"\");\r\n        //         console.log(\"---------------->\"+item.iframeComponent)\r\n        return {\r\n          name: name,\r\n          path: item.path,\r\n          hasOpen: false, // 是否打开过，默认false\r\n          component: item.iframeComponent, // 组件文件的引用\r\n        };\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n"],"sourceRoot":"src/components/base"}]}
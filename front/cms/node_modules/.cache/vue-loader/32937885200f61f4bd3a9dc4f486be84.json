{"remainingRequest":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuguanghui/Documents/cms_code/my-message/cms/src/views/login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/src/views/login.vue","mtime":1640433935952},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldFVzZXJJbmZvIH0gZnJvbSAiQC9hcGkvZ2V0RGF0YS5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlclNlbGVjdFBvc2l0aW9uOnt9LAogICAgICBjYXJyeW92ZXJQb3NpdGlvbjpbXSwKICAgICAgZGlhbG9nOmZhbHNlLAogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICBsb2FkaW5nRXJyb3I6IGZhbHNlLAogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmc6ICgpID0+IGltcG9ydCgiLi9sb2dpbkxvYWRpbmcudnVlIiksCiAgICBMb2dpbkVycm9yOiAoKSA9PiBpbXBvcnQoIkAvY29tcG9uZW50cy9iYXNlL2Vycm9yLXZpZXcudnVlIiksCiAgfSwKICBtb3VudGVkKCkgewogICAgbGV0IGF1dGhvcml6YXRpb24gPSB0aGlzLiRyb3V0ZS5xdWVyeTsKICAgIGNvbnNvbGUubG9nKCJhdXRob3JpemF0aW9uID09PT0+ICIrSlNPTi5zdHJpbmdpZnkoYXV0aG9yaXphdGlvbikpCiAgICBjb25zb2xlLmxvZyhhdXRob3JpemF0aW9uKQoKICAgIGlmIChhdXRob3JpemF0aW9uID09IG51bGwgfHwgdHlwZW9mIGF1dGhvcml6YXRpb24gPT0gInVuZGVmaW5lZCIpIHsKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIubG9naW5TdGF0dXMpIHsKICAgICAgICB0aGlzLnRvSW5kZXhQYWdlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5sb2FkaW5nRXJyb3IgPSB0cnVlOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLiRzdG9yZS5jb21taXQoInVzZXIvc2V0QXV0aG9yaXphdGlvbiIsSlNPTi5zdHJpbmdpZnkoYXV0aG9yaXphdGlvbikpOwogICAgZ2V0VXNlckluZm8oKQogICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coInVzZXJpbmZvPT09PT0+IiArIEpTT04uc3RyaW5naWZ5KHJlcykpOwogICAgICAgIGlmIChyZXMgPT0gbnVsbCB8fCB0eXBlb2YgcmVzID09ICJ1bmRlZmluZWQiIHx8IHJlcy5jb2RlICE9IDApIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCIgY29kZSBteWJheSBudWxsICIrcmVzLmNvZGUpCiAgICAgICAgICB0aGlzLmxvYWRpbmdFcnJvciA9IHRydWU7CiAgICAgICAgfSBlbHNlIGlmKHJlcy5kYXRhLnBvc2l0aW9uTGlzdCA9PT0gbnVsbCB8fCB0eXBlb2YgcmVzLmRhdGEucG9zaXRpb25MaXN0ID09PSAidW5kZWZpbmVkIiB8fCByZXMuZGF0YS5wb3NpdGlvbkxpc3QubGVuZ3RoID09PSAwKSB7IAogICAgICAgICAgY29uc29sZS5sb2coInVzZXIgcG9zaXRpb24gaXMgbnVsbCA9PT0gPiIrSlNPTi5zdHJpbmdpZnkocmVzLmRhdGEudXNlckluZm8ucG9zaXRpb25MaXN0KSkKICAgICAgICAgIHRoaXMubG9hZGluZ0Vycm9yID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coIj09PSBlbnRlciBtYWluIHBhZ2UgPT09IikKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgidXNlci9zZXRVc2VyIiwgcmVzLmRhdGEpOyAgCiAgICAgICAgICBsZXQgcG9zaXRpb24gPSByZXMuZGF0YS5wb3NpdGlvbkxpc3Q7CiAgICAgICAgICBjb25zb2xlLmxvZygidXNlciBwb3NpdGlvbnMgPT09PiAiK0pTT04uc3RyaW5naWZ5KHBvc2l0aW9uKSkKICAgICAgICAgIGlmKHBvc2l0aW9uLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiPT09IHVzZXIgaGFzIG9ubGUgb25lIHBvc2l0aW9uID09PSIpCiAgICAgICAgICAgIHRoaXMuZGlhbG9nID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMudXNlclNlbGVjdFBvc2l0aW9uID0gcG9zaXRpb25bMF0uY29kZTsKICAgICAgICAgICAgdGhpcy5vblNlbGVjdFBvc2l0aW9uKCk7ICAgICAKICAgICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIj09PSB1c2VyIGhhcyBtYW55IHBvc2l0aW9uID09PSAiKQogICAgICAgICAgICB0aGlzLmNhcnJ5b3ZlclBvc2l0aW9uID0gcG9zaXRpb247CiAgICAgICAgICAgIHRoaXMuZGlhbG9nID0gdHJ1ZTsKICAgICAgICAgIH0gCiAgICAgICAgfQogICAgICB9KQogICAgICAuY2F0Y2goKGUpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygiIG9uIGVycm9yICIrSlNPTi5zdHJpbmdpZnkoZSkpCiAgICAgICAgdGhpcy5sb2FkaW5nRXJyb3IgPSB0cnVlOwogICAgICB9KQogICAgICAuZmluYWxseSgoKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIH0pOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIG9uU2VsZWN0UG9zaXRpb24oKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJ1c2VyL3NldFBvc2l0aW9uIiwgdGhpcy51c2VyU2VsZWN0UG9zaXRpb24pOwogICAgICAgIHRoaXMuZGlhbG9nID0gZmFsc2U7CiAgICAgICAgdGhpcy50b0luZGV4UGFnZSgpOwogICAgfSwKICAgIHRvSW5kZXhQYWdlKCl7CiAgICAgIHZhciBpbmRleCA9IHRoaXMuJHN0b3JlLmdldHRlcnNbInVzZXIvZ2V0SW5kZXhQYWdlIl0KICAgICAgaWYoaW5kZXggIT0gbnVsbCAmJiB0eXBlb2YgaW5kZXggIT0gdW5kZWZpbmVkKXsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKGluZGV4LnBhdGgpOwogICAgICB9IAogICAgfQogIH0sCgp9Owo="},{"version":3,"sources":["login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <v-app>\n    <loading v-if=\"loading\" />\n    <login-error v-if=\"loadingError\" />\n    <template>\n      <v-row justify=\"space-around\">\n        <v-col cols=\"auto\">\n          <v-dialog\n            persistent\n            scrollable\n            v-model=\"dialog\"\n            transition=\"dialog-bottom-transition\"\n            max-width=\"600\"\n          >\n            <template >\n              <v-card>\n                <v-toolbar\n                  color=\"primary\"\n                  dark\n                >请选择您登录MyMessage的角色</v-toolbar>\n                <v-card-text>\n                  <v-radio-group v-model=\"userSelectPosition\">\n                      <v-radio\n                        class=\"mt-0\"\n                        v-for=\"(item,index) in carryoverPosition\"\n                        :key=\"index\"\n                        :value=\"item.code\"\n                      >\n                      <template v-slot:label>\n                        <v-col>\n                        <strong class=\"primary--text\">{{`${item.jobName}`}}</strong>\n                        <v-divider class=\"mt-1\"/>  \n                        </v-col>\n                    </template>   \n                                  \n                      </v-radio>  \n                    </v-radio-group>\n                </v-card-text>\n                \n              <div style=\"margin-top: 24px; height: 60px;margin-bottom:15px\">\n                <v-btn\n                style=\"margin-left: 190px;\"\n                :disabled=\"JSON.stringify(userSelectPosition) === '{}'\"\n                  depressed color=\"#1867C0\"  \n                  class=\"white--text\"\n                  min-width=\"205px\"\n                  height=\"36px\"\n                  @click=\"onSelectPosition\"\n                >\n                  确认\n                </v-btn>\n            </div>     \n              </v-card>\n            </template>\n          </v-dialog>\n        </v-col>\n      </v-row>\n    </template>\n</v-app>\n</template>\n\n<script>\nimport { getUserInfo } from \"@/api/getData.js\";\nexport default {\n  data() {\n    return {\n      userSelectPosition:{},\n      carryoverPosition:[],\n      dialog:false,\n      loading: true,\n      loadingError: false,\n    };\n  },\n  components: {\n    Loading: () => import(\"./loginLoading.vue\"),\n    LoginError: () => import(\"@/components/base/error-view.vue\"),\n  },\n  mounted() {\n    let authorization = this.$route.query;\n    console.log(\"authorization ====> \"+JSON.stringify(authorization))\n    console.log(authorization)\n\n    if (authorization == null || typeof authorization == \"undefined\") {\n      if (this.$store.state.user.loginStatus) {\n        this.toIndexPage();\n      } else {\n        this.loading = false;\n        this.loadingError = true;\n      }\n      return;\n    }\n\n    this.$store.commit(\"user/setAuthorization\",JSON.stringify(authorization));\n    getUserInfo()\n      .then((res) => {\n        console.log(\"userinfo=====>\" + JSON.stringify(res));\n        if (res == null || typeof res == \"undefined\" || res.code != 0) {\n          console.log(\" code mybay null \"+res.code)\n          this.loadingError = true;\n        } else if(res.data.positionList === null || typeof res.data.positionList === \"undefined\" || res.data.positionList.length === 0) { \n          console.log(\"user position is null === >\"+JSON.stringify(res.data.userInfo.positionList))\n          this.loadingError = true;\n        } else {\n          console.log(\"=== enter main page ===\")\n          this.$store.commit(\"user/setUser\", res.data);  \n          let position = res.data.positionList;\n          console.log(\"user positions ===> \"+JSON.stringify(position))\n          if(position.length === 1) {\n            console.log(\"=== user has onle one position ===\")\n            this.dialog = false;\n            this.userSelectPosition = position[0].code;\n            this.onSelectPosition();     \n          }else {\n            console.log(\"=== user has many position === \")\n            this.carryoverPosition = position;\n            this.dialog = true;\n          } \n        }\n      })\n      .catch((e) => {\n        console.log(\" on error \"+JSON.stringify(e))\n        this.loadingError = true;\n      })\n      .finally(() => {\n        this.loading = false;\n      });\n  },\n\n  methods: {\n    onSelectPosition() {\n        this.$store.commit(\"user/setPosition\", this.userSelectPosition);\n        this.dialog = false;\n        this.toIndexPage();\n    },\n    toIndexPage(){\n      var index = this.$store.getters[\"user/getIndexPage\"]\n      if(index != null && typeof index != undefined){\n          this.$router.push(index.path);\n      } \n    }\n  },\n\n};\n</script>\n"]}]}
{"remainingRequest":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/src/components/base/iframe-router-view.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/src/components/base/iframe-router-view.vue","mtime":1638103240516},{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/IIT/2023 summary course/iit-project/IIT-CMS/front/cms/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgVnVlIGZyb20gInZ1ZS9kaXN0L3Z1ZS5qcyI7DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGNvbXBvbmVudHNBcnI6IFtdLA0KICAgIH07DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLy8g5a6e546w5oeS5Yqg6L2977yM5Y+q5riy5p+T5bey57uP5omT5byA6L+H77yIaGFzT3Blbjp0cnVl77yJ55qEaWZyYW1l6aG1DQogICAgaGFzT3BlbkNvbXBvbmVudHNBcnIoKSB7DQogICAgICByZXR1cm4gdGhpcy5jb21wb25lbnRzQXJyLmZpbHRlcigoaXRlbSkgPT4gaXRlbS5oYXNPcGVuKTsNCiAgICB9LA0KICB9LA0KICB3YXRjaDogew0KICAgICRyb3V0ZSgpIHsNCiAgICAgIC8vIOWIpOaWreW9k+WJjei3r+eUseaYr+WQpmlmcmFtZemhtQ0KICAgICAgdGhpcy5pc09wZW5JZnJhbWVQYWdlKCk7DQogICAgfSwNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICAvLyDorr7nva5pZnJhbWXpobXnmoTmlbDnu4Tlr7nosaENCiAgICBjb25zdCBjb21wb25lbnRzQXJyID0gdGhpcy5nZXRDb21wb25lbnRzQXJyKCk7DQogICAgY29tcG9uZW50c0Fyci5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICBWdWUuY29tcG9uZW50KGl0ZW0ubmFtZSwgaXRlbS5jb21wb25lbnQpOw0KICAgIH0pOw0KICAgIHRoaXMuY29tcG9uZW50c0FyciA9IGNvbXBvbmVudHNBcnI7DQogICAgLy8g5Yik5pat5b2T5YmN6Lev55Sx5piv5ZCmaWZyYW1l6aG1DQogICAgdGhpcy5pc09wZW5JZnJhbWVQYWdlKCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDmoLnmja7lvZPliY3ot6/nlLHorr7nva5oYXNPcGVuDQogICAgaXNPcGVuSWZyYW1lUGFnZSgpIHsNCiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuY29tcG9uZW50c0Fyci5maW5kKChpdGVtKSA9PiB7DQogICAgICAgIHJldHVybiBpdGVtLnBhdGggPT09IHRoaXMuJHJvdXRlLnBhdGg7DQogICAgICB9KTsNCiAgICAgIGlmICh0YXJnZXQgJiYgIXRhcmdldC5oYXNPcGVuKSB7DQogICAgICAgIHRhcmdldC5oYXNPcGVuID0gdHJ1ZTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOmBjeWOhui3r+eUseeahOaJgOaciemhtemdou+8jOaKiuWQq+aciWlmcmFtZUNvbXBvbmVudOagh+ivhueahOaUtumbhui1t+adpQ0KICAgIGdldENvbXBvbmVudHNBcnIoKSB7DQogICAgICBjb25zdCByb3V0ZXIgPSB0aGlzLiRyb3V0ZXI7DQogICAgICBjb25zdCByb3V0ZXMgPSByb3V0ZXIub3B0aW9ucy5yb3V0ZXM7DQogICAgICBjb25zdCBjaGlsZHJlbiA9IHJvdXRlcy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uY2hpbGRyZW4pOw0KICAgICAgY29uc3QgaWZyYW1lQXJyID0gY2hpbGRyZW5bMF0uY2hpbGRyZW4uZmlsdGVyKA0KICAgICAgICAoaXRlbSkgPT4gaXRlbS5pZnJhbWVDb21wb25lbnQNCiAgICAgICk7DQoNCiAgICAgIHJldHVybiBpZnJhbWVBcnIubWFwKChpdGVtKSA9PiB7DQogICAgICAgIGNvbnN0IG5hbWUgPSBpdGVtLm5hbWUgfHwgaXRlbS5wYXRoLnJlcGxhY2UoIi8iLCAiIik7DQogICAgICAgIC8vICAgICAgICAgY29uc29sZS5sb2coIi0tLS0tLS0tLS0tLS0tLS0+IitpdGVtLmlmcmFtZUNvbXBvbmVudCkNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICBuYW1lOiBuYW1lLA0KICAgICAgICAgIHBhdGg6IGl0ZW0ucGF0aCwNCiAgICAgICAgICBoYXNPcGVuOiBmYWxzZSwgLy8g5piv5ZCm5omT5byA6L+H77yM6buY6K6kZmFsc2UNCiAgICAgICAgICBjb21wb25lbnQ6IGl0ZW0uaWZyYW1lQ29tcG9uZW50LCAvLyDnu4Tku7bmlofku7bnmoTlvJXnlKgNCiAgICAgICAgfTsNCiAgICAgIH0pOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["iframe-router-view.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"iframe-router-view.vue","sourceRoot":"src/components/base","sourcesContent":["<template>\r\n  <div>\r\n    <!-- Vue的router-view -->\r\n    <keep-alive>\r\n      <router-view v-if=\"$route.meta.keepAlive\" />\r\n    </keep-alive>\r\n    <router-view v-if=\"!$route.meta.keepAlive\" />\r\n\r\n    <!-- iframe页 -->\r\n\r\n    <component\r\n      :is=\"item.component\"\r\n      v-for=\"item in hasOpenComponentsArr\"\r\n      v-show=\"$route.path === item.path\"\r\n      :key=\"item.name\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue/dist/vue.js\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      componentsArr: [],\r\n    };\r\n  },\r\n  computed: {\r\n    // 实现懒加载，只渲染已经打开过（hasOpen:true）的iframe页\r\n    hasOpenComponentsArr() {\r\n      return this.componentsArr.filter((item) => item.hasOpen);\r\n    },\r\n  },\r\n  watch: {\r\n    $route() {\r\n      // 判断当前路由是否iframe页\r\n      this.isOpenIframePage();\r\n    },\r\n  },\r\n  created() {\r\n    // 设置iframe页的数组对象\r\n    const componentsArr = this.getComponentsArr();\r\n    componentsArr.forEach((item) => {\r\n      Vue.component(item.name, item.component);\r\n    });\r\n    this.componentsArr = componentsArr;\r\n    // 判断当前路由是否iframe页\r\n    this.isOpenIframePage();\r\n  },\r\n  methods: {\r\n    // 根据当前路由设置hasOpen\r\n    isOpenIframePage() {\r\n      const target = this.componentsArr.find((item) => {\r\n        return item.path === this.$route.path;\r\n      });\r\n      if (target && !target.hasOpen) {\r\n        target.hasOpen = true;\r\n      }\r\n    },\r\n    // 遍历路由的所有页面，把含有iframeComponent标识的收集起来\r\n    getComponentsArr() {\r\n      const router = this.$router;\r\n      const routes = router.options.routes;\r\n      const children = routes.filter((item) => item.children);\r\n      const iframeArr = children[0].children.filter(\r\n        (item) => item.iframeComponent\r\n      );\r\n\r\n      return iframeArr.map((item) => {\r\n        const name = item.name || item.path.replace(\"/\", \"\");\r\n        //         console.log(\"---------------->\"+item.iframeComponent)\r\n        return {\r\n          name: name,\r\n          path: item.path,\r\n          hasOpen: false, // 是否打开过，默认false\r\n          component: item.iframeComponent, // 组件文件的引用\r\n        };\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]}]}
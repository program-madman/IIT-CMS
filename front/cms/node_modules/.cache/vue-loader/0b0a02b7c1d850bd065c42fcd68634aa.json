{"remainingRequest":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuguanghui/Documents/cms_code/my-message/cms/src/components/statisticalReportView.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/src/components/statisticalReportView.vue","mtime":1640181455857},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTdXBwbGllclJlcG9ydFZpZXcgZnJvbSAiQC9jb21wb25lbnRzL3N0YXRpc3RpY2FsUmVwb3J0U3VwcGxpZXJWaWV3LnZ1ZSI7CmltcG9ydCB7IGdldFJlbWluZGVyRGVhbGVycyxzZW5kTWVzc2FnZVJlbWluZCxnZXRBcnRpY2xlQXJlYXMsZ2V0QWxsRGVhbGVyUmVwb3J0fSBmcm9tICJAL2FwaS9nZXREYXRhLmpzIjsKaW1wb3J0IHsgZG93bmxvYWRSZXBseVJlcG9ydCB9IGZyb20gIkAvdXRpbHMvZG93bmxvYWRyZXBseXJlcC5qcyI7CmltcG9ydCB7cm91bmRGdW4sdGV4dEVsbGlwc2lzfSBmcm9tICJAL3V0aWxzL3N0cmluZ1V0aWxzLmpzIjsKaW1wb3J0IHsgc2hvd1NuYWNrYmFyLCBjbG9zZVNuYWNrYmFyIH0gZnJvbSAiQC91dGlscy9zbmFja2Jhci5qcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogInN0YXRpc3RpY2FsUmVwb3J0VmlldyIsICAKCiAgcHJvcHM6IFsnbXNnSWRQYXJhbScsJ2ZlZWJhY2tCYWNrVHlwZSddLAoKICBjb21wb25lbnRzOiB7CiAgICBTdXBwbGllclJlcG9ydFZpZXcsCiAgICBsb2FkaW5nOiAoKSA9PiBpbXBvcnQoIkAvY29tcG9uZW50cy9iYXNlL2xvYWRpbmcudnVlIiksCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8v54q25oCB77ya5bey6K+744CB5pyq6K+7CiAgICAgIFNUQVRVU19SRUFEOiAwLAogICAgICBTVEFUVVNfVU5SRUFEOiAxLAoKICAgICAgLy/nu5/orqHmn6Xor6LnsbvlnosgMDog6ZiF6K+757G75Z6L5p+l6K+iIDE6IOmZhOS7tuexu+Wei+afpeivoiAyOiDlm57lpI3nsbvlnovmn6Xor6IKICAgICAgU1RBVElTVElDU1NUQVRVU19UWVBFX1JFQUQ6IDAsCiAgICAgIFNUQVRJU1RJQ1NTVEFUVVNfVFlQRV9BVFRBQ0g6IDEsCiAgICAgIFNUQVRJU1RJQ1NTVEFUVVNfVFlQRV9SRVBMWTogMiwKICAgICAgLy/liqDovb3nirbmgIEKICAgICAgbG9hZGluZ3ZpZXc6IHRydWUsCiAgICAgIHJlbWluZGVyTG9hZGluZzpmYWxzZSwKCiAgICAgIERFQUxFUlRZUEU6IFsKICAgICAgICB7IHRleHQ6ICLlhajpg6giLCBpZDogIiIgfSwKICAgICAgICB7IHRleHQ6ICI0U+W6lyIsIGlkOiAiMSIgfSwKICAgICAgICB7IHRleHQ6ICLni6znq4vllK7lkI4iLCBpZDogIjAiIH0sCiAgICAgICAgeyB0ZXh0OiAi5LqM57qn572R54K5IiwgaWQ6ICIyIiB9LAogICAgICBdLAoKICAgICAgcmVtaW5kRGlhbG9nOiBmYWxzZSwKICAgICAgc2VhcmNoX3NlbGU6ICIiLAogICAgICBzZWxlY3RlZF9hcmVhOiBbXSwKICAgICAgZXhwYW5kZWQ6IFtdLAogICAgICBjbGlja0FyZWFOYW1lOiBbXSwKICAgICAgc3RhdGlzdGljc1N0YXR1czogMCwKICAgICAgYXR0YWNobWVudElkOiAwLAoKICAgICAgcmVtaW5kZXJDb21wYW55TGlzdDogW10sCiAgICAgIHVuU2VsZWN0ZWRSZW1pbmRlclVzZXJJZDogW10sCiAgICAgIHVuU2VsZWN0UmVtaW5kZXJDb21wYW55SWRzOiBbXSwKCiAgICAgIGRpYWxvZ19zdXBwbGllcjogZmFsc2UsCiAgICAgIG1zZ0lEOiB0aGlzLm1zZ0lkUGFyYW0sCgogICAgICBoZWFkZXJzOiBbXSwKICAgICAgZGVzc2VydHNfYXJlYTogW10sCgogICAgICBpc1NlbmRpbmc6ZmFsc2UsCgogICAgICBpdGVtc19zdGF0dXM6IFsi5pyq6K+7Iiwi5bey6K+7Il0sCiAgICAgIGFydGljbGVfYXJlYXM6W10sCiAgICAgIGl0ZW1zX2FyZWE6IFtdLAogICAgICBpdGVtc190eXBlOiBbXSwKCgogICAgICBzZWxlY3RSZWFkVmFsdWU6IHRoaXMuU1RBVFVTX1VOUkVBRCwKICAgICAgc2VsZWN0VHlwZVZhbHVlOiAiIiwKCiAgICAgIHNlbGVjdF9zdGF0dXM6ICLmnKror7siLAogICAgICBzZWxlY3RfYXJlYTogIuWFqOmDqCIsCiAgICAgIHNlbGVjdF90eXBlOiBbXSwKICAgICAgCiAgICAgIHVuU2VsZWN0Q29tYW55SW5mb01hcEluZm86IG5ldyBNYXAoKSwKCiAgICAgIHJlbWluZGVyaGVhZGVyczogWwogICAgICAgIHsgdGV4dDogIuWMuuWfnyIsIHZhbHVlOiAiYXJlYSIgfSwKICAgICAgICB7IHRleHQ6ICLnu4/plIDllYYiLCB2YWx1ZTogImNvbXBhbnlOYW1lIiB9LAogICAgICBdLAogICAgfTsKICB9LAoKICBtb3VudGVkKCkgewogICAgY29uc29sZS5sb2coCiAgICAgICJtb3VudGVkIC0tLSBtc2dJRDoiICsKICAgICAgICB0aGlzLm1zZ0lEICsKICAgICAgICAiIGZlZWJhY2tCYWNrVHlwZToiICsKICAgICAgICB0aGlzLmZlZWJhY2tCYWNrVHlwZQogICAgKTsKCiAgICB0aGlzLml0ZW1zX3R5cGUgPSB0aGlzLkRFQUxFUlRZUEU7CiAgICB0aGlzLnNlbGVjdF90eXBlID0geyB0ZXh0OiAi5YWo6YOoIiwgaWQ6ICIiIH07CiAgICB0aGlzLnNlbGVjdFJlYWRWYWx1ZSA9IHRoaXMuU1RBVFVTX1VOUkVBRDsKCiAgICAvL+iOt+WPluaWh+eroOWMuuWfnyAgICAKICAgIHRoaXMuZ2V0QXJ0aWNsZUFyZWFzU2VydmljZSgpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIAogICAgLyoqCiAgICAgKiDojrflj5bmlofnq6Dlj5HluIPml7bmiYDpgInljLrln58KICAgICAqLwogICAgZ2V0QXJ0aWNsZUFyZWFzU2VydmljZSgpewogICAgICAgIGdldEFydGljbGVBcmVhcyh0aGlzLm1zZ0lEKQogICAgICAgLnRoZW4oKHJlcykgPT4gewoKICAgICAgICAgIGNvbnNvbGUubG9nKCJnZXRBcnRpY2xlQXJlYXMgcmVjZWl2ZToiICsgSlNPTi5zdHJpbmdpZnkocmVzKSk7CgogICAgICAgICAgaWYgKHJlcy5kYXRhID09IG51bGwpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coImRhdGEgc2l6ZSBpcyAwIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnByb2Nlc3NBcmVhUmVzcG9uc2UocmVzLmRhdGEpOwoKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKT0+ewogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIH0pICAgICAgIAogICAgfSwgICAgICAgCiAgICAKICAgIC8qKgogICAgICog5Yid5aeL5YyW5Yy65Z+f5pWw5o2u5ZON5bqUCiAgICAgKi8KICAgIHByb2Nlc3NBcmVhUmVzcG9uc2UoZGF0YSl7CiAgICAgICAgLy/liJ3lp4vljJbljLrln58KICAgICAgICB0aGlzLmluaXRJdGVtc0FyZWEoZGF0YSk7ICAgICAgICAgIAoKICAgICAgICAvL+W8gOWni+afpeivouaKpeWRigogICAgICAgIHRoaXMuZ2V0RGVhbGVyUmVwb3J0U2VydmljZSgpOwogICAgfSwKCiAgICAvKioKICAgICAqIOiOt+WPluafpeivouadoeS7tuWvueW6lOeahOWMuuWfnwogICAgICovCiAgICBnZXRRdWVyeUFyZWEoc2VsZWN0QXJlYSl7CiAgICAgIGNvbnNvbGUubG9nKCdnZXRRdWVyeUFyZWE6JytzZWxlY3RBcmVhKTsgICAgICAKICAgICAgaWYoc2VsZWN0QXJlYSA9PSAi5YWo6YOoIil7CiAgICAgICAgICByZXR1cm4gdGhpcy5hcnRpY2xlX2FyZWFzOwogICAgICB9ZWxzZXsKICAgICAgICAgIHJldHVybiBbc2VsZWN0QXJlYV07ICAgICAgICAgICAKICAgICAgfQogICAgfSwKCiAgICAvKioKICAgICAqIOiOt+WPlue7n+iuoeaKpeWRigogICAgICovCiAgICBnZXREZWFsZXJSZXBvcnRTZXJ2aWNlKCkgewogICAgICAgIHRoaXMucmVzZXREYXRhKCk7CiAgICAgICAgdGhpcy5sb2FkaW5ndmlldyA9IHRydWU7CgogICAgICAgIGdldEFsbERlYWxlclJlcG9ydCh0aGlzLm1zZ0lELHRoaXMuZ2V0UXVlcnlBcmVhKHRoaXMuc2VsZWN0X2FyZWEpLHRoaXMuc2VsZWN0VHlwZVZhbHVlLHRoaXMuc2VhcmNoX3NlbGUpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZygiZ2V0RGVhbGVyUmVwb3J0IHJlY2VpdmU6IiArIEpTT04uc3RyaW5naWZ5KHJlcykpOwoKICAgICAgICAgICAgaWYgKHJlcy5kYXRhID09IG51bGwpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZGF0YSBzaXplIGlzIDAiKTsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuaGVhZGVycyA9IHRoaXMuaW5pdEhlYWRlckRhdGEocmVzLmRhdGEucmVwb3J0cyk7CiAgICAgICAgICAgIGlmKHJlcy5kYXRhLnJlcG9ydHMubGVuZ3RoPT0wKXsKICAgICAgICAgICAgICB0aGlzLmRlc3NlcnRzX2FyZWEgPSBbXTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgdGhpcy5kZXNzZXJ0c19hcmVhID0gdGhpcy5pbml0Qm9keURhdGEocmVzLmRhdGEucmVwb3J0cyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgICAgfSkKICAgICAgICAuZmluYWxseSgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMubG9hZGluZ3ZpZXcgPSBmYWxzZTsKICAgICAgICB9KTsKICAgIH0sCgogICAgcmVzZXREYXRhKCkgewogICAgICB0aGlzLmhlYWRlcnMgPSBbXTsKICAgICAgdGhpcy5kZXNzZXJ0c19hcmVhID0gW107CiAgICB9LAoKICAgIC8v5p6E5bu65Y2V5LiqaGVhZGVy5aS05L+h5oGvCiAgICBidWlsZEhlYWRlckJlYW4odGV4dCwgdmFsdWUpIHsKICAgICAgbGV0IGhlYWRlckJlYW4gPSB7fTsKICAgICAgaGVhZGVyQmVhbi50ZXh0ID0gdGV4dEVsbGlwc2lzKHRleHQsMjApOwoKICAgICAgaGVhZGVyQmVhbi52YWx1ZSA9IHZhbHVlOwogICAgICBoZWFkZXJCZWFuLndpZHRoID0gIjEwcmVtIjsKICAgICAgaGVhZGVyQmVhbi5hbGlnbiA9ICJsZWZ0IjsKCiAgICAgIHJldHVybiBoZWFkZXJCZWFuOwogICAgfSwKCiAgICAvKioKICAgICAqIOWIneWni+WMlumAieaLqeWMuuWfnwogICAgICovCiAgICBpbml0SXRlbXNBcmVhKGRhdGEpIHsKICAgICAgdGhpcy5hcnRpY2xlX2FyZWFzID0gW107CiAgICAgIHRoaXMuaXRlbXNfYXJlYSA9IFsn5YWo6YOoJ107CgogICAgICBkYXRhLmZvckVhY2goKGFyZWFOYW1lKSA9PiB7CiAgICAgICAgICB0aGlzLml0ZW1zX2FyZWEucHVzaChhcmVhTmFtZSk7CiAgICAgICAgICB0aGlzLmFydGljbGVfYXJlYXMucHVzaChhcmVhTmFtZSk7CiAgICAgIH0pOwogICAgfSwKCiAgICAvL+WIneWni+WMlkhlYWRlcueahOaVsOaNrgogICAgaW5pdEhlYWRlckRhdGEoZGF0YSkgewogICAgICBsZXQgaGVhZGVyRGF0YUFycmF5ID0gW107CgogICAgICBoZWFkZXJEYXRhQXJyYXkucHVzaCh0aGlzLmJ1aWxkSGVhZGVyQmVhbigi5ZCN56ewIiwgImFyZWEiKSk7ICAgCiAgICAgIGlmKHRoaXMuc2VsZWN0UmVhZFZhbHVlID09IHRoaXMuU1RBVFVTX1VOUkVBRCl7CiAgICAgICAgICBoZWFkZXJEYXRhQXJyYXkucHVzaCh0aGlzLmJ1aWxkSGVhZGVyQmVhbigi5pyq6K+757uf6K6hIiwgInJlYWRpbmciKSk7CiAgICAgIH1lbHNlewogICAgICAgICAgaGVhZGVyRGF0YUFycmF5LnB1c2godGhpcy5idWlsZEhlYWRlckJlYW4oIuW3suivu+e7n+iuoSIsICJyZWFkaW5nIikpOwogICAgICB9ICAgCiAgICAgIC8v5aaC5p6c5piv5peg6ZyA6KaB5Zue5aSN55qE5paH56ug77yM5q2k5YiX5LiN6ZyA6KaB5bGV56S6CiAgICAgIGlmKHRoaXMuZmVlYmFja0JhY2tUeXBlIT00KXsKICAgICAgICAgIGhlYWRlckRhdGFBcnJheS5wdXNoKHRoaXMuYnVpbGRIZWFkZXJCZWFuKCLlt7Llm57lpI3nu5/orqEiLCAicmVwbHkiKSk7CiAgICAgIH0KICAgICAgCiAgICAgIGlmIChkYXRhLmxlbmd0aD09MCkgewogICAgICAgIGNvbnNvbGUubG9nKCJpbml0SGVhZGVyRGF0YTphdHRhY2htZW50U3RhdGlzdGljcyBpcyAwIik7CiAgICAgICAgcmV0dXJuIGhlYWRlckRhdGFBcnJheTsKICAgICAgfQoKICAgICAgY29uc29sZS5sb2coImluaXRIZWFkZXJEYXRhOmRhdGEgIitKU09OLnN0cmluZ2lmeShkYXRhKSk7CgogICAgICBsZXQgYXR0YWNoTmFtZUxpc3QgPSBbXTsKCiAgICAgIGRhdGEuZm9yRWFjaCgoc3VwcGxpZXJEYXRhKT0+ewogICAgICAgICAgaWYoc3VwcGxpZXJEYXRhLmF0dGFjaG1lbnRSZXBvcnRzIT1udWxsJiZzdXBwbGllckRhdGEuYXR0YWNobWVudFJlcG9ydHMubGVuZ3RoPjAKICAgICAgICAgICAgJiZhdHRhY2hOYW1lTGlzdC5sZW5ndGg9PTApeyAgICAgICAgICAgIAogICAgICAgICAgICAgIHN1cHBsaWVyRGF0YS5hdHRhY2htZW50UmVwb3J0cy5mb3JFYWNoKChhdHRhY2htZW50U3RhdGlzdGljcykgPT4gewogICAgICAgICAgICAgIGxldCBhdHRhY2htZW50TmFtZSA9IGF0dGFjaG1lbnRTdGF0aXN0aWNzLmF0dGFjaG1lbnROYW1lLnNsaWNlKAogICAgICAgICAgICAgICAgICBhdHRhY2htZW50U3RhdGlzdGljcy5hdHRhY2htZW50TmFtZS5sYXN0SW5kZXhPZigiLyIpICsgMQogICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgIGF0dGFjaE5hbWVMaXN0LnB1c2goCiAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkSGVhZGVyQmVhbigKICAgICAgICAgICAgICAgICAgIuW3suS4i+i9vee7n+iuoSgiICsgYXR0YWNobWVudE5hbWUgKyAiKSIsCiAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnRTdGF0aXN0aWNzLmF0dGFjaG1lbnROYW1lCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSk7ICAgICAgICAgIAogICAgICAgICAgfQogICAgICB9KTsgICAgICAgIAogICAgICAKICAgICAgYXR0YWNoTmFtZUxpc3QuZm9yRWFjaCgoaGVhZGVyQmVhbik9PnsKICAgICAgICAgIGhlYWRlckRhdGFBcnJheS5wdXNoKGhlYWRlckJlYW4pOwogICAgICB9KTsKICAgICAgCiAgICAgIHJldHVybiBoZWFkZXJEYXRhQXJyYXk7CiAgICB9LAoKICAgIC8qKgogICAgICog6ZiF6K+757uf6K6h6LWL5YC8CiAgICAgKi8KICAgIGNvbXBvc2VSZWFkU3RhdGlzdGljc0RhdGEoYm9keUJlYW4saGF2ZVJlYWRDb3VudCxyZWFkQ291bnQpewogICAgICAgICAgaWYodGhpcy5zZWxlY3RSZWFkVmFsdWUgPT0gdGhpcy5TVEFUVVNfUkVBRCl7CiAgICAgICAgICAgICAgYm9keUJlYW4ucmVhZGluZ1N0YXRpc3RpY3NDb3VudCA9IGhhdmVSZWFkQ291bnQ7CiAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICBib2R5QmVhbi5yZWFkaW5nU3RhdGlzdGljc0NvdW50ID0gcmVhZENvdW50IC0gaGF2ZVJlYWRDb3VudDsKICAgICAgICAgIH0gICAgICAgICAgCiAgICAgICAgICBib2R5QmVhbi5yZWFkaW5nVG90YWxDb3VudCA9IHJlYWRDb3VudDsKICAgICAgICAgIGJvZHlCZWFuLnJlYWRpbmdQZXJjZW50YWdlID0gcm91bmRGdW4oYm9keUJlYW4ucmVhZGluZ1N0YXRpc3RpY3NDb3VudCxib2R5QmVhbi5yZWFkaW5nVG90YWxDb3VudCk7ICAgICAgICAKICAgIH0sCgogICAgLyoqCiAgICAgKiDpmIXor7vnu5/orqHlj43ppogKICAgICAqLwogICAgY29tcG9zZUZlZWRiYWNrRGF0YShib2R5QmVhbixoYXZlRmVlZGJhY2tDb3VudCxmZWVkYmFja0NvdW50KXsgICAgICAKICAgICAgICAgIGJvZHlCZWFuLnJlcGx5U3RhdGlzdGljc0NvdW50ID0gaGF2ZUZlZWRiYWNrQ291bnQ7ICAgICAgICAgICAgCiAgICAgICAgICBib2R5QmVhbi5yZXBseVRvdGFsQ291bnQgPSBmZWVkYmFja0NvdW50OwogICAgICAgICAgYm9keUJlYW4ucmVwbHlQZXJjZW50YWdlID0gcm91bmRGdW4oYm9keUJlYW4ucmVwbHlTdGF0aXN0aWNzQ291bnQsYm9keUJlYW4ucmVwbHlUb3RhbENvdW50KTsKICAgIH0sCgogICAgLyoqCiAgICAgKiDnu4Too4XpmYTku7bmlofku7YKICAgICAqLwogICAgY29tcG9zZUF0dGFjaEZpbGUoYXR0YWNobWVudFN0YXRpc3RpY3MpewogICAgICAgIGxldCBhdHRhY2hEYXRhID0ge307CiAgICAgICAgCiAgICAgICAgYXR0YWNoRGF0YS5hdHRhY2htZW50SWQgPSBhdHRhY2htZW50U3RhdGlzdGljcy5hdHRhY2htZW50SWQ7CiAgICAgICAgYXR0YWNoRGF0YS52YWx1ZVN0YXRpc3RpY3NDb3VudCA9IGF0dGFjaG1lbnRTdGF0aXN0aWNzLmhhdmVEb3dubG9hZENvdW50OyAgICAgICAgCiAgICAgICAgYXR0YWNoRGF0YS52YWx1ZVRvdGFsQ291bnQgPSBhdHRhY2htZW50U3RhdGlzdGljcy5kb3dubG9hZENvdW50OwogICAgICAgIGF0dGFjaERhdGEudmFsdWVQZXJjZW50YWdlID0gcm91bmRGdW4oYXR0YWNoRGF0YS52YWx1ZVN0YXRpc3RpY3NDb3VudCxhdHRhY2hEYXRhLnZhbHVlVG90YWxDb3VudCk7CgogICAgICAgIHJldHVybiBhdHRhY2hEYXRhOwogICAgfSwKCiAgICAvKioKICAgICAqIOaWsOW7uuS4gOS4qumZhOS7tuWvueixoQogICAgICovCiAgICBidWlsZE5ld0F0dGFjaG1lbnREYXRhKCl7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgaWQ6ICIiLAogICAgICAgICAgICBzdGF0aXN0aWNzQ291bnQ6IDAsCiAgICAgICAgICAgIHRvdGFsQ291bnQ6IDAsICAgICAgICAgIAogICAgICAgIH07CiAgICB9LAogICAKICAgIC8qKgogICAgICog57uE6KOF6KGo5qC85YaF5a65CiAgICAgKi8KICAgIGluaXRCb2R5RGF0YShkYXRhKSB7CiAgICAgICAgbGV0IGRhdGFBcnJheSA9IFtdOwogICAgICAgIGxldCB0b3RhbGluZm8gPSB7fTsKICAgICAgICBsZXQgdG90YWxBdHRhY2htZW50U3RhdGlzdGljcyA9IFtdOwoKICAgICAgICB0b3RhbGluZm8uYXJlYSA9ICLlkIjorqEiOwoKICAgICAgICBsZXQgcmVhZFN0YXRpc3RpY3NDb3VudCA9IDAsCiAgICAgICAgICByZWFkU3RhdGlzdGljc1RvdGFsQ291bnQgPSAwOwogICAgICAgIGxldCBmZWVkYmFja1N0YXRpc3RpY3NDb3VudCA9IDAsCiAgICAgICAgICBmZWVkYmFja1N0YXRpc3RpY3NUb3RhbENvdW50ID0gMDsKCiAgICAgICAgZGF0YS5mb3JFYWNoKChzdGF0aXN0aWNzUmVwb3J0KSA9PiB7CgogICAgICAgICAgICAgIGlmKHN0YXRpc3RpY3NSZXBvcnQuYXJlYT09bnVsbCl7IAogICAgICAgICAgICAgICAgcmV0dXJuOyAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgbGV0IGJvZHlCZWFuID0ge307CgogICAgICAgICAgICAgIGJvZHlCZWFuLmFyZWEgPSBzdGF0aXN0aWNzUmVwb3J0LmFyZWE7CgogICAgICAgICAgICAgIC8v6ZiF6K+757uf6K6h6LWL5YC8CiAgICAgICAgICAgICAgdGhpcy5jb21wb3NlUmVhZFN0YXRpc3RpY3NEYXRhKGJvZHlCZWFuLHN0YXRpc3RpY3NSZXBvcnQuaGF2ZVJlYWRDb3VudCxzdGF0aXN0aWNzUmVwb3J0LnJlYWRDb3VudCk7CiAgICAgICAgICAgICAgcmVhZFN0YXRpc3RpY3NDb3VudCArPSBib2R5QmVhbi5yZWFkaW5nU3RhdGlzdGljc0NvdW50OwogICAgICAgICAgICAgIHJlYWRTdGF0aXN0aWNzVG90YWxDb3VudCArPSBib2R5QmVhbi5yZWFkaW5nVG90YWxDb3VudDsKCiAgICAgICAgICAgICAgLy/lm57lpI3nu5/orqHotYvlgLwKICAgICAgICAgICAgICB0aGlzLmNvbXBvc2VGZWVkYmFja0RhdGEoYm9keUJlYW4sc3RhdGlzdGljc1JlcG9ydC5oYXZlRmVlZGJhY2tDb3VudCxzdGF0aXN0aWNzUmVwb3J0LmZlZWRiYWNrQ291bnQpOwogICAgICAgICAgICAgIGZlZWRiYWNrU3RhdGlzdGljc0NvdW50ICs9IGJvZHlCZWFuLnJlcGx5U3RhdGlzdGljc0NvdW50OwogICAgICAgICAgICAgIGZlZWRiYWNrU3RhdGlzdGljc1RvdGFsQ291bnQgKz0gYm9keUJlYW4ucmVwbHlUb3RhbENvdW50OyAgIAoKICAgICAgICAgICAgICAvL+mZhOS7tuS4i+i9vee7n+iuoQogICAgICAgICAgICAgIGxldCBhdHRhY2hEYXRhTGlzdCA9IFtdOwoKICAgICAgICAgICAgICBzdGF0aXN0aWNzUmVwb3J0LmF0dGFjaG1lbnRSZXBvcnRzLmZvckVhY2goCiAgICAgICAgICAgICAgICAoYXR0YWNobWVudFN0YXRpc3RpY3MsIGluZGV4KSA9PiB7ICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgICBpZiAodG90YWxBdHRhY2htZW50U3RhdGlzdGljc1tpbmRleF0gPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICB0b3RhbEF0dGFjaG1lbnRTdGF0aXN0aWNzW2luZGV4XSA9IHRoaXMuYnVpbGROZXdBdHRhY2htZW50RGF0YSgpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAvL+iuvue9rumZhOS7tuaVsOaNrgogICAgICAgICAgICAgICAgICBsZXQgYXR0YWNoRGF0YSA9IHRoaXMuY29tcG9zZUF0dGFjaEZpbGUoYXR0YWNobWVudFN0YXRpc3RpY3MpOwogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgdG90YWxBdHRhY2htZW50U3RhdGlzdGljc1tpbmRleF0uYXR0YWNobWVudElkID0gYXR0YWNobWVudFN0YXRpc3RpY3MuYXR0YWNobWVudElkOwogICAgICAgICAgICAgICAgICB0b3RhbEF0dGFjaG1lbnRTdGF0aXN0aWNzW2luZGV4XS5zdGF0aXN0aWNzQ291bnQgKz0gYXR0YWNoRGF0YS52YWx1ZVN0YXRpc3RpY3NDb3VudDsKICAgICAgICAgICAgICAgICAgdG90YWxBdHRhY2htZW50U3RhdGlzdGljc1tpbmRleF0udG90YWxDb3VudCArPSBhdHRhY2hEYXRhLnZhbHVlVG90YWxDb3VudDsKCiAgICAgICAgICAgICAgICAgIGF0dGFjaERhdGFMaXN0LnB1c2goYXR0YWNoRGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgYm9keUJlYW4uYXR0YWNoRGF0YUxpc3QgPSBhdHRhY2hEYXRhTGlzdDsKCiAgICAgICAgICAgICAgZGF0YUFycmF5LnB1c2goYm9keUJlYW4pOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIHRvdGFsaW5mby5yZWFkaW5nU3RhdGlzdGljc0NvdW50ID0gcmVhZFN0YXRpc3RpY3NDb3VudDsKICAgICAgICAgICAgdG90YWxpbmZvLnJlYWRpbmdUb3RhbENvdW50ID0gcmVhZFN0YXRpc3RpY3NUb3RhbENvdW50OwogICAgICAgICAgICB0b3RhbGluZm8ucmVhZGluZ1BlcmNlbnRhZ2UgPSByb3VuZEZ1bihyZWFkU3RhdGlzdGljc0NvdW50LHJlYWRTdGF0aXN0aWNzVG90YWxDb3VudCk7CgogICAgICAgICAgICB0b3RhbGluZm8ucmVwbHlTdGF0aXN0aWNzQ291bnQgPSBmZWVkYmFja1N0YXRpc3RpY3NDb3VudDsKICAgICAgICAgICAgdG90YWxpbmZvLnJlcGx5VG90YWxDb3VudCA9IGZlZWRiYWNrU3RhdGlzdGljc1RvdGFsQ291bnQ7CiAgICAgICAgICAgIHRvdGFsaW5mby5yZXBseVBlcmNlbnRhZ2UgPSByb3VuZEZ1bihmZWVkYmFja1N0YXRpc3RpY3NDb3VudCxmZWVkYmFja1N0YXRpc3RpY3NUb3RhbENvdW50KTsKCiAgICAgICAgICAgIHRvdGFsaW5mby5hdHRhY2hEYXRhTGlzdCA9IFtdOwogICAgICAgICAgICB0b3RhbEF0dGFjaG1lbnRTdGF0aXN0aWNzLmZvckVhY2goKGF0dGFjaG1lbnRTdGF0aXN0aWNzKSA9PiB7CiAgICAgICAgICAgICAgbGV0IGF0dGFjaERhdGEgPSB7fTsKCiAgICAgICAgICAgIGF0dGFjaERhdGEuYXR0YWNobWVudElkID0gYXR0YWNobWVudFN0YXRpc3RpY3MuYXR0YWNobWVudElkOwogICAgICAgICAgICBhdHRhY2hEYXRhLnZhbHVlU3RhdGlzdGljc0NvdW50ID0gYXR0YWNobWVudFN0YXRpc3RpY3Muc3RhdGlzdGljc0NvdW50OwogICAgICAgICAgICBhdHRhY2hEYXRhLnZhbHVlVG90YWxDb3VudCA9IGF0dGFjaG1lbnRTdGF0aXN0aWNzLnRvdGFsQ291bnQ7CiAgICAgICAgICAgIGF0dGFjaERhdGEudmFsdWVQZXJjZW50YWdlID0gcm91bmRGdW4oYXR0YWNobWVudFN0YXRpc3RpY3Muc3RhdGlzdGljc0NvdW50LGF0dGFjaG1lbnRTdGF0aXN0aWNzLnRvdGFsQ291bnQpOwoKICAgICAgICAgICAgdG90YWxpbmZvLmF0dGFjaERhdGFMaXN0LnB1c2goYXR0YWNoRGF0YSk7CiAgICAgICAgfSk7CgogICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgInRvdGFsQXR0YWNobWVudFN0YXRpc3RpY3M6IiArIEpTT04uc3RyaW5naWZ5KHRvdGFsaW5mby5hdHRhY2hEYXRhTGlzdCkKICAgICAgICApOwoKICAgICAgICBkYXRhQXJyYXkudW5zaGlmdCh0b3RhbGluZm8pOwoKICAgICAgICByZXR1cm4gZGF0YUFycmF5OwogICAgfSwgICAgCgogICAgY2xvc2VSZW1pbmRlcigpIHsKICAgICAgY29uc29sZS5sb2coIi4uLi4uLuWFs+mXreaPkOmGkuaMiemSri4uLi4uLi4iKTsKICAgICAgdGhpcy5yZW1pbmREaWFsb2cgPSBmYWxzZTsKICAgICAgY2xvc2VTbmFja2JhcigpOwogICAgfSwKCiAgICAvL+WFs+mXrQogICAgYnRfY2xvc2UoKSB7CiAgICAgIGNvbnNvbGUubG9nKCIuLi4uLi7lhbPpl63mjInpkq4uLi4uLi4uIik7CiAgICAgIHRoaXMuJGVtaXQoImNsb3NlZENoaWxkIiwgZmFsc2UpOwogICAgfSwKICAgIC8v5YWz6ZetZGlhbG9nCiAgICBjbG9zZVBhcmVudCh1blNlbGVjdENvbWFueUluZm9NYXBJbmZvKSB7CiAgICAgIGNvbnNvbGUubG9nKCItLS0tLS0tLS0tLSIgKyB0aGlzLm5vd0RpYWxvZyk7CiAgICAgIHRoaXMuZGlhbG9nX3N1cHBsaWVyID0gZmFsc2U7CgogICAgICB0aGlzLnVuU2VsZWN0Q29tYW55SW5mb01hcEluZm8uY2xlYXIoKTsKICAgICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIHVuU2VsZWN0Q29tYW55SW5mb01hcEluZm8uZW50cmllcygpKSB7CiAgICAgICAgdGhpcy51blNlbGVjdENvbWFueUluZm9NYXBJbmZvLnNldChrZXksIHZhbHVlKTsKICAgICAgfQogICAgfSwKCiAgICAvKioKICAgICAqIOiOt+WPlumcgOimgeaOkumZpOeahOWFrOWPuOWIl+ihqAogICAgICovCiAgICBnZXRVblNlbGVjdENvbXBhbnlDb2RlTGlzdCgpewogICAgICAgIGxldCBleGNsdWRlQ29tcGFueUNvZGUgPSBbXTsKCiAgICAgICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIHRoaXMudW5TZWxlY3RDb21hbnlJbmZvTWFwSW5mby5lbnRyaWVzKCkpIHsKICAgICAgICAgICAgaWYodmFsdWUubGVuZ3RoPT0wKXsgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZXhjbHVkZUNvbXBhbnlDb2RlLnB1c2goa2V5KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc29sZS5sb2coJ2dldFVuU2VsZWN0Q29tcGFueUNvZGVMaXN0OicrSlNPTi5zdHJpbmdpZnkoZXhjbHVkZUNvbXBhbnlDb2RlKSk7CgogICAgICAgIHJldHVybiBleGNsdWRlQ29tcGFueUNvZGU7ICAgICAgCiAgICB9LAoKICAgIC8qKgogICAgICog6I635Y+W6ZyA6KaB5o6S6Zmk55qE55So5oi35YiX6KGoCiAgICAgKi8KICAgIGdldFVuc2VsZWN0VXNlckxpc3QoKXsKICAgICAgICBsZXQgZXhjbHVkZVVzZXJMaXN0ID0gW107CgogICAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiB0aGlzLnVuU2VsZWN0Q29tYW55SW5mb01hcEluZm8uZW50cmllcygpKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJrZXk6IitrZXkrIiB2YWx1ZToiK0pTT04uc3RyaW5naWZ5KHZhbHVlKSk7CiAgICAgICAgICAgIGlmKHZhbHVlLmxlbmd0aD4wKXsgICAgICAgCiAgICAgICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKChpdGVtKT0+ewogICAgICAgICAgICAgICAgICBleGNsdWRlVXNlckxpc3QucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgIH0pOyAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNvbnNvbGUubG9nKCdnZXRVbnNlbGVjdFVzZXJMaXN0OicrSlNPTi5zdHJpbmdpZnkoZXhjbHVkZVVzZXJMaXN0KSk7CgogICAgICAgIHJldHVybiBleGNsdWRlVXNlckxpc3Q7CiAgICB9LCAgCgogICAgLy/mmL7npLpSZW1pbmRlcuW8ueWHuuahhgogICAgc2hvd1JlbWluZGVyRGlhbG9nKCl7CiAgICAgICAgdGhpcy5yZW1pbmREaWFsb2cgPSB0cnVlOwogICAgICAgIHRoaXMucmVtaW5kZXJMb2FkaW5nID0gdHJ1ZTsKCiAgICAgICAgZ2V0UmVtaW5kZXJEZWFsZXJzKHRoaXMubXNnSUQsdGhpcy5nZXRVblNlbGVjdENvbXBhbnlDb2RlTGlzdCgpKQogICAgICAgIC50aGVuKChyZXMpID0+IHsgICAgICAgICAgICAKICAgICAgICAgICAgaWYocmVzLmNvZGU9PScwJyl7CiAgICAgICAgICAgICAgICB0aGlzLnJlbWluZGVyQ29tcGFueUxpc3QgPSByZXMuZGF0YTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICB0aGlzLnJlbWluZGVyQ29tcGFueUxpc3QgPSBbXTsKICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgICAgICBjb25zb2xlLmxvZygncmVtaW5kZXJDb21wYW55TGlzdDonK0pTT04uc3RyaW5naWZ5KHRoaXMucmVtaW5kZXJDb21wYW55TGlzdCkpOwogICAgICAgIH0pLmZpbmFsbHkoKCk9PnsKICAgICAgICAgIHRoaXMucmVtaW5kZXJMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSk7CgogICAgfSwKICAgIC8v5Y+R6YCB5o+Q6YaSCiAgICBzZW5kUmVtaW5kZXIoKSB7CiAgICAgIGNvbnNvbGUubG9nKCIuLi4uLi7lj5HpgIHmj5DphpIuLi4uLi4uIik7CgogICAgICB0aGlzLmlzU2VuZGluZyA9IHRydWU7CiAgICAgIHRoaXMucmVtaW5kRGlhbG9nID0gZmFsc2U7ICAgICAgCgogICAgICBzZW5kTWVzc2FnZVJlbWluZCgKICAgICAgICB0aGlzLm1zZ0lELAogICAgICAgIHRoaXMuZ2V0VW5TZWxlY3RDb21wYW55Q29kZUxpc3QoKSwKICAgICAgICB0aGlzLmdldFVuc2VsZWN0VXNlckxpc3QoKQogICAgICAgICkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIGlmKHJlcy5jb2RlPT0wKXsKICAgICAgICAgICAgICBzaG93U25hY2tiYXIoIuWPkemAgeaIkOWKnyIpOyAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgICAgaWYgKGVycm9yLnJlc3BvbnNlID09IG51bGwgfHwgdHlwZW9mIGVycm9yLnJlc3BvbnNlID09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGxldCByZXMgPSBlcnJvci5yZXNwb25zZTsKICAgICAgICAgIGlmIChyZXMuZGF0YSA9PSBudWxsIHx8IHR5cGVvZiByZXMuZGF0YSA9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgZGF0YSA9IHJlcy5kYXRhOwogICAgICAgICAgaWYgKAogICAgICAgICAgICBkYXRhLmNvZGUgIT0gbnVsbCAmJmRhdGEuY29kZT09JzI4JwogICAgICAgICAgKSB7CiAgICAgICAgICAgIHNob3dTbmFja2JhcigiMeWwj+aXtuWGheWPquiDveWPkemAgTHmrKHmj5DphpLvvIzor7fnqI3lkI7lho3or5Xor5UiKTsgICAgICAgICAgICAKICAgICAgICAgIH0KCiAgICAgICAgfSkuZmluYWxseSgoKT0+eyAgICAgICAgICAgIAogICAgICAgICAgICB0aGlzLmlzU2VuZGluZyA9IGZhbHNlOwogICAgICAgIH0pOwogICAgfSwKICAgIC8v5p+l5om+CiAgICBidF9zZWFyY2goKSB7CiAgICAgIGNvbnNvbGUubG9nKCIuLi4uLi7mn6Xmib4uLi4uLi4uOiIgKyB0aGlzLnNlYXJjaF9zZWxlKTsKICAgICAgaWYgKHRoaXMuc2VhcmNoX3NlbGUgIT0gIiIpIHsKICAgICAgICAgIHRoaXMuZ2V0RGVhbGVyUmVwb3J0U2VydmljZSgpOwogICAgICB9CiAgICB9LAogICAgLy/ov5jljp8KICAgIGJ0X3Jlc2V0KCkgewogICAgICBjb25zb2xlLmxvZygiLi4uLi4u6L+Y5Y6fLi4uLi4uLiIpOwogICAgICB0aGlzLnNlYXJjaF9zZWxlID0gIiI7CiAgICAgICh0aGlzLnNlbGVjdF9zdGF0dXMgPSAi5pyq6K+7IiksCiAgICAgICAgKHRoaXMuc2VsZWN0X3R5cGUgPSB7IHRleHQ6ICLlhajpg6giLCBpZDogIiIgfSk7CiAgICAgIHRoaXMuc2VsZWN0UmVhZFZhbHVlID0gdGhpcy5TVEFUVVNfVU5SRUFEOwogICAgICB0aGlzLnNlbGVjdF9hcmVhID0gIuWFqOmDqCI7CgogICAgICB0aGlzLmdldERlYWxlclJlcG9ydFNlcnZpY2UoKTsKICAgIH0sCiAgICAvL+eKtuaAgemAieaLqeeahOWAvOaUueWPmAogICAgc2VsZWN0U3RhdHVzQ2hhbmdlKCkgewogICAgICBjb25zb2xlLmxvZygiLi4uLueKtuaAgemAieaLqS4uLi4gOiIgKyB0aGlzLnNlbGVjdF9zdGF0dXMpOwogICAgICBpZiAodGhpcy5zZWxlY3Rfc3RhdHVzID09ICLmnKror7siKSB7CiAgICAgICAgdGhpcy5zZWxlY3RSZWFkVmFsdWUgPSB0aGlzLlNUQVRVU19VTlJFQUQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zZWxlY3RSZWFkVmFsdWUgPSB0aGlzLlNUQVRVU19SRUFEOwogICAgICB9CgogICAgICB0aGlzLmdldERlYWxlclJlcG9ydFNlcnZpY2UoKTsKICAgIH0sCiAgICAvL+WMuuWfn+mAieaLqeeahOWAvOaUueWPmAogICAgc2VsZWN0QXJlYUNoYW5nZSgpIHsKICAgICAgY29uc29sZS5sb2coIi4uLi7ljLrln5/pgInmi6kuLi4uIDoiICsgdGhpcy5zZWxlY3RfYXJlYSk7CgogICAgICB0aGlzLmdldERlYWxlclJlcG9ydFNlcnZpY2UoKTsKICAgIH0sCiAgICBleHBvcnRSZXBseSgpIHsKICAgICAgY29uc29sZS5sb2coIi4uLi7lr7zlh7rlm57lpI3pmYTku7YuLi4uIDoiICsgdGhpcy5zZWxlY3RfYXJlYSk7CgogICAgICBsZXQgY3VycmVudFRpbWUgPSBNYXRoLnJvdW5kKCtuZXcgRGF0ZSgpIC8gMTAwMCk7CgogICAgICAvL+aWh+Wtl+WbnuWkjQogICAgICBpZiAodGhpcy5mZWViYWNrQmFja1R5cGUgPT0gMikgewogICAgICAgIGRvd25sb2FkUmVwbHlSZXBvcnQodGhpcy5tc2dJRCwgIuWbnuWkjeWGheWuuV8iICsgY3VycmVudFRpbWUgKyAiLnppcCIpOwogICAgICB9ZWxzZXsvL+mZhOS7tuWbnuWkjQogICAgICAgIGRvd25sb2FkUmVwbHlSZXBvcnQodGhpcy5tc2dJRCwgIuWbnuWkjeWGheWuuV8iICsgY3VycmVudFRpbWUgKyAiLnhscyIpOwogICAgICB9CiAgICB9LAogICAgLy/nsbvlnovpgInmi6nnmoTlgLzmlLnlj5gKICAgIHNlbGVjdFR5cGVDaGFuZ2UoKSB7CiAgICAgIHRoaXMuc2VsZWN0VHlwZVZhbHVlID0gdGhpcy5zZWxlY3RfdHlwZS5pZDsKCiAgICAgIGNvbnNvbGUubG9nKCIuLi4u57G75Z6L6YCJ5oupLi4uLiBzZWxlY3RUeXBlVmFsdWU6IiArIHRoaXMuc2VsZWN0VHlwZVZhbHVlKTsKCiAgICAgIHRoaXMuZ2V0RGVhbGVyUmVwb3J0U2VydmljZSgpOwogICAgfSwKICAgIC8v5b2TdGFibGUgcm93IGNsaWNr5pe26Kem5Y+RCiAgICBjbGlja1JvdzogZnVuY3Rpb24gKHR5cGUsIGFyZWEsIGF0dGFjaElkKSB7ICAgIAogICAgICBpZihhcmVhPT0n5ZCI6K6hJyl7ICAgICAgICAKICAgICAgICAvLyAgdGhpcy5jbGlja0FyZWFOYW1lID0gdGhpcy5nZXRRdWVyeUFyZWEoJ+WFqOmDqCcpOwogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlewogICAgICAgICB0aGlzLmNsaWNrQXJlYU5hbWUgPSB0aGlzLmdldFF1ZXJ5QXJlYShhcmVhKTsKICAgICAgfQogICAgICB0aGlzLnN0YXRpc3RpY3NTdGF0dXMgPSB0eXBlOwogICAgICB0aGlzLmF0dGFjaG1lbnRJZCA9IGF0dGFjaElkOwoKICAgICAgY29uc29sZS5sb2coCiAgICAgICAgIi4uLi5yb3dDbGljay4uLi4gc3RhdGlzdGljc1N0YXR1czoiICsKICAgICAgICAgIHRoaXMuc3RhdGlzdGljc1N0YXR1cyArCiAgICAgICAgICAiICBjbGlja0FyZWFOYW1lOiIgKwogICAgICAgICAgSlNPTi5zdHJpbmdpZnkodGhpcy5jbGlja0FyZWFOYW1lKSArCiAgICAgICAgICAiIGF0dGFjaG1lbnRJZDoiICsKICAgICAgICAgIHRoaXMuYXR0YWNobWVudElkCiAgICAgICk7CgogICAgICB0aGlzLmRpYWxvZ19zdXBwbGllciA9IHRydWU7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["statisticalReportView.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsQA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"statisticalReportView.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-card class=\"mx-auto\">\n    <v-toolbar dense color=\"#1867C0\">\n      <v-btn icon>\n        <v-icon color=\"white\" @click=\"bt_close\"> mdi-close </v-icon>\n      </v-btn>\n      <v-toolbar-title class=\"body-1 white--text\">统计报告</v-toolbar-title>\n    </v-toolbar>\n    <div class=\"pl-8 pr-8 pt-4\">\n      <span class=\"body-1 grey--text text--darken-3\"> 经销商 </span>\n      <v-row align=\"center\" class=\"mt-6 ml-1 mb-4\">        \n        <v-dialog v-model=\"remindDialog\" max-width=\"720px\" height=\"630px\" scrollable>\n          <template v-slot:activator=\"{ on, attrs }\">\n            <v-btn\n              class=\"white--text\"\n              color=\"#1867C0\"\n              small\n              depress\n              v-bind=\"attrs\"\n              v-on=\"on\"\n              @click=\"showReminderDialog\"\n            >\n              发送提醒\n            </v-btn>\n          </template>\n          <v-card>\n            <v-card-title style=\"font-size: 20px;\">将向以下经销商对应的人员发送提醒</v-card-title>\n            <v-divider></v-divider>\n            <v-card-text style=\"height: 500px;\">  \n            <loading v-if=\"reminderLoading\" />     \n            <template v-else>\n                <template v-if=\"this.reminderCompanyList.length>0\">\n                  <v-data-table\n                    :headers=\"reminderheaders\"\n                    :items=\"reminderCompanyList\"\n                    item-key=\"id\"                \n                    class=\"mt-8 elevation-1\"\n                    hide-default-footer\n                    disable-pagination\n                    dense\n                  >\n                  </v-data-table>      \n                </template>\n                <template v-else>\n                  <v-row class=\"fill-height\">\n                      <v-col class=\"fill-height d-flex flex-column justify-center align-center\">\n                          <h3 class=\"gray--text\"><div>未找到需要提醒的经销商</div></h3>\n                      </v-col>\n                  </v-row>            \n                </template>\n            </template>   \n          </v-card-text>\n\n            <v-divider></v-divider>\n            <v-card-actions style=\"height:70px\">\n              <v-row justify=\"center\">\n                <v-btn min-width=\"105px\" height=\"36px\" dark outlined color=\"#1867C0FF\" style=\"margin-right: 24px\" @click=\"closeReminder\">\n                  取消\n                </v-btn>\n                <v-btn :disabled=\"this.reminderCompanyList.length==0\" class=\"white--text\" min-width=\"105px\" height=\"36px\" color=\"#1867C0\" @click=\"sendReminder\">\n                  发送\n                </v-btn>\n              </v-row>\n            </v-card-actions>\n          </v-card>          \n        </v-dialog>\n        <v-dialog v-model=\"isSending\" max-width=\"720px\">\n          <v-card color=\"grey lighten-4\" dark>\n              <v-card-text style=\" color:black;\">\n                  正在发送，请稍候\n                <v-progress-linear\n                  indeterminate\n                ></v-progress-linear>\n              </v-card-text>\n          </v-card>\n        </v-dialog>\n        <!-- 已读回执、附件、文本回复，三种类型需要支持导出 -->\n        <v-btn\n          v-if=\"this.feebackBackType != 4\"\n          class=\"ml-4\"\n          color=\"#1867C0\"\n          small\n          text\n          depress\n          @click=\"exportReply\"\n        >\n          <v-icon small>mdi-export</v-icon>\n          回复附件导出\n        </v-btn>\n      </v-row>\n\n      <v-row class=\"pl-4 pt-3 pb-5 pr-4\" justify=\"center\">\n\n        <v-combobox\n          v-model=\"select_status\"\n          :items=\"items_status\"\n          height=\"36px\"\n          style=\"width: 60px\"\n          class=\"pa-0 mr-4 mr-sm-2\"\n          label=\"状态\"\n          @change=\"selectStatusChange\"\n          outlined\n          dense\n        ></v-combobox>\n\n        <v-combobox\n          v-model=\"select_area\"\n          :items=\"items_area\"\n          height=\"36px\"\n          style=\"width: 60px\"\n          class=\"pa-0 mr-4 mr-sm-2\"\n          label=\"区域\"\n          @change=\"selectAreaChange\"\n          outlined\n          dense\n        ></v-combobox>\n\n        <v-combobox\n          v-model=\"select_type\"\n          :items=\"items_type\"\n          item-value=\"id\"\n          item-text=\"text\"\n          height=\"36px\"\n          style=\"width: 60px\"\n          label=\"类型\"\n          class=\"pa-0 mr-4 mr-sm-2\"\n          @change=\"selectTypeChange\"\n          outlined\n          dense\n        ></v-combobox>\n\n        <v-text-field\n          v-model=\"search_sele\"\n          flat\n          style=\"height: 36px; min-width: 140px;width: 320px;\"\n          hide-details\n          clearable        \n          label=\"按照经销商名称和编码查找\"\n          placeholder=\"按照经销商名称和编码查找\"\n          maxlength=\"60\"\n          counter=\"60\"\n          append-icon=\"mdi-magnify\"\n          outlined\n          dense\n          class=\"ml-sm-0 ml-md-2 mr-4\"\n        ></v-text-field>\n\n        <v-btn\n          outlined\n          class=\"blue--text text--darken-2 mr-4\"\n          height=\"38px\"\n          width=\"97px\"\n          @click=\"bt_search\"\n        >\n          查找\n        </v-btn>\n        <v-btn\n          outlined\n          width=\"97px\"\n          class=\"blue--text text--darken-2\"\n          height=\"38px\"\n          @click=\"bt_reset\"\n        >\n          还原\n        </v-btn>\n      </v-row>\n\n      <template>\n        <loading v-if=\"loadingview\" />\n        <v-data-table\n          v-else\n          :headers=\"headers\"\n          :items=\"desserts_area\"\n          item-key=\"area\"\n          class=\"mt-4 elevation-1\"\n          hide-default-footer\n        >\n          <template v-slot:body=\"{ items }\">\n            <tbody v-if=\"items.length > 0\">\n              <tr v-for=\"item in items\" :key=\"item.area\" style=\"width: 200px\">\n                <td style=\"text-align: left\">{{ item.area }}</td>\n                <td\n                  style=\"text-align: left\"\n                  @click=\"\n                    clickRow(STATISTICSSTATUS_TYPE_READ, item.area, -1, item)\n                  \"\n                >\n                  <span style=\"color: #1867c0\">{{\n                    item.readingStatisticsCount\n                  }}</span\n                  >/{{ item.readingTotalCount }} {{ item.readingPercentage }}%\n                </td>\n                <td\n                  style=\"text-align: left\"\n                  v-if=\"feebackBackType!=4\"\n                  @click=\"\n                    clickRow(STATISTICSSTATUS_TYPE_REPLY, item.area, -1, item)\n                  \"\n                >\n                  <span style=\"color: #1867c0\">{{\n                    item.replyStatisticsCount\n                  }}</span\n                  >/{{ item.replyTotalCount }} {{ item.replyPercentage }}%\n                </td>\n\n                <td\n                  v-for=\"attachment in item.attachDataList\"\n                  :key=\"attachment.attachmentName\"\n                  @click=\"\n                    clickRow(\n                      STATISTICSSTATUS_TYPE_ATTACH,\n                      item.area,\n                      attachment.attachmentId,\n                      item\n                    )\n                  \"\n                >\n                  <span style=\"color: #1867c0\">{{\n                    attachment.valueStatisticsCount\n                  }}</span\n                  >/{{ attachment.valueTotalCount }}\n                  {{ attachment.valuePercentage }}%\n                </td>\n              </tr>\n            </tbody>\n            <tbody v-else>\n              <tr>\n                <td :colspan=\"headers.length\" style=\"text-align: center\">\n                  No Results Here!\n                </td>\n              </tr>\n            </tbody>\n          </template>\n        </v-data-table>\n\n        <v-divider class=\"#E4E8EB\"></v-divider>\n\n        <v-dialog\n          v-model=\"dialog_supplier\"\n          fullscreen\n          hide-overlay\n          transition=\"dialog-bottom-transition\"\n        >\n          <SupplierReportView\n            @closedChild=\"closeParent\"\n            :areaparam=\"clickAreaName\"\n            :msgIDParam=\"msgID\"\n            :openStatus=\"dialog_supplier\"\n            :readStatusParam=\"selectReadValue\"\n            :statisticsStatusParam=\"statisticsStatus\"\n            :attachmentIdParam=\"attachmentId\"\n            :selectTypeValueParam=\"selectTypeValue\"\n            :feebackBackType=\"feebackBackType\"\n            :searchContentParam = \"this.search_sele\"\n          ></SupplierReportView>\n        </v-dialog>\n      </template>\n    </div>\n  </v-card>\n</template>\n\n<script>\nimport SupplierReportView from \"@/components/statisticalReportSupplierView.vue\";\nimport { getReminderDealers,sendMessageRemind,getArticleAreas,getAllDealerReport} from \"@/api/getData.js\";\nimport { downloadReplyReport } from \"@/utils/downloadreplyrep.js\";\nimport {roundFun,textEllipsis} from \"@/utils/stringUtils.js\";\nimport { showSnackbar, closeSnackbar } from \"@/utils/snackbar.js\";\n\nexport default {\n  name: \"statisticalReportView\",  \n\n  props: ['msgIdParam','feebackBackType'],\n\n  components: {\n    SupplierReportView,\n    loading: () => import(\"@/components/base/loading.vue\"),\n  },\n\n  data() {\n    return {\n      //状态：已读、未读\n      STATUS_READ: 0,\n      STATUS_UNREAD: 1,\n\n      //统计查询类型 0: 阅读类型查询 1: 附件类型查询 2: 回复类型查询\n      STATISTICSSTATUS_TYPE_READ: 0,\n      STATISTICSSTATUS_TYPE_ATTACH: 1,\n      STATISTICSSTATUS_TYPE_REPLY: 2,\n      //加载状态\n      loadingview: true,\n      reminderLoading:false,\n\n      DEALERTYPE: [\n        { text: \"全部\", id: \"\" },\n        { text: \"4S店\", id: \"1\" },\n        { text: \"独立售后\", id: \"0\" },\n        { text: \"二级网点\", id: \"2\" },\n      ],\n\n      remindDialog: false,\n      search_sele: \"\",\n      selected_area: [],\n      expanded: [],\n      clickAreaName: [],\n      statisticsStatus: 0,\n      attachmentId: 0,\n\n      reminderCompanyList: [],\n      unSelectedReminderUserId: [],\n      unSelectReminderCompanyIds: [],\n\n      dialog_supplier: false,\n      msgID: this.msgIdParam,\n\n      headers: [],\n      desserts_area: [],\n\n      isSending:false,\n\n      items_status: [\"未读\",\"已读\"],\n      article_areas:[],\n      items_area: [],\n      items_type: [],\n\n\n      selectReadValue: this.STATUS_UNREAD,\n      selectTypeValue: \"\",\n\n      select_status: \"未读\",\n      select_area: \"全部\",\n      select_type: [],\n      \n      unSelectComanyInfoMapInfo: new Map(),\n\n      reminderheaders: [\n        { text: \"区域\", value: \"area\" },\n        { text: \"经销商\", value: \"companyName\" },\n      ],\n    };\n  },\n\n  mounted() {\n    console.log(\n      \"mounted --- msgID:\" +\n        this.msgID +\n        \" feebackBackType:\" +\n        this.feebackBackType\n    );\n\n    this.items_type = this.DEALERTYPE;\n    this.select_type = { text: \"全部\", id: \"\" };\n    this.selectReadValue = this.STATUS_UNREAD;\n\n    //获取文章区域    \n    this.getArticleAreasService();\n  },\n\n  methods: {\n    \n    /**\n     * 获取文章发布时所选区域\n     */\n    getArticleAreasService(){\n        getArticleAreas(this.msgID)\n       .then((res) => {\n\n          console.log(\"getArticleAreas receive:\" + JSON.stringify(res));\n\n          if (res.data == null) {\n            console.log(\"data size is 0\");\n            return;\n          }\n\n          this.processAreaResponse(res.data);\n\n        })\n        .catch((res)=>{\n            console.log(res);\n        })       \n    },       \n    \n    /**\n     * 初始化区域数据响应\n     */\n    processAreaResponse(data){\n        //初始化区域\n        this.initItemsArea(data);          \n\n        //开始查询报告\n        this.getDealerReportService();\n    },\n\n    /**\n     * 获取查询条件对应的区域\n     */\n    getQueryArea(selectArea){\n      console.log('getQueryArea:'+selectArea);      \n      if(selectArea == \"全部\"){\n          return this.article_areas;\n      }else{\n          return [selectArea];           \n      }\n    },\n\n    /**\n     * 获取统计报告\n     */\n    getDealerReportService() {\n        this.resetData();\n        this.loadingview = true;\n\n        getAllDealerReport(this.msgID,this.getQueryArea(this.select_area),this.selectTypeValue,this.search_sele)\n        .then((res) => {\n            console.log(\"getDealerReport receive:\" + JSON.stringify(res));\n\n            if (res.data == null) {\n              console.log(\"data size is 0\");\n              return;\n            }\n\n            this.headers = this.initHeaderData(res.data.reports);\n            if(res.data.reports.length==0){\n              this.desserts_area = [];\n            }else{\n              this.desserts_area = this.initBodyData(res.data.reports);\n            }\n        })\n        .catch((res) => {\n            console.log(res);\n        })\n        .finally(() => {\n            this.loadingview = false;\n        });\n    },\n\n    resetData() {\n      this.headers = [];\n      this.desserts_area = [];\n    },\n\n    //构建单个header头信息\n    buildHeaderBean(text, value) {\n      let headerBean = {};\n      headerBean.text = textEllipsis(text,20);\n\n      headerBean.value = value;\n      headerBean.width = \"10rem\";\n      headerBean.align = \"left\";\n\n      return headerBean;\n    },\n\n    /**\n     * 初始化选择区域\n     */\n    initItemsArea(data) {\n      this.article_areas = [];\n      this.items_area = ['全部'];\n\n      data.forEach((areaName) => {\n          this.items_area.push(areaName);\n          this.article_areas.push(areaName);\n      });\n    },\n\n    //初始化Header的数据\n    initHeaderData(data) {\n      let headerDataArray = [];\n\n      headerDataArray.push(this.buildHeaderBean(\"名称\", \"area\"));   \n      if(this.selectReadValue == this.STATUS_UNREAD){\n          headerDataArray.push(this.buildHeaderBean(\"未读统计\", \"reading\"));\n      }else{\n          headerDataArray.push(this.buildHeaderBean(\"已读统计\", \"reading\"));\n      }   \n      //如果是无需要回复的文章，此列不需要展示\n      if(this.feebackBackType!=4){\n          headerDataArray.push(this.buildHeaderBean(\"已回复统计\", \"reply\"));\n      }\n      \n      if (data.length==0) {\n        console.log(\"initHeaderData:attachmentStatistics is 0\");\n        return headerDataArray;\n      }\n\n      console.log(\"initHeaderData:data \"+JSON.stringify(data));\n\n      let attachNameList = [];\n\n      data.forEach((supplierData)=>{\n          if(supplierData.attachmentReports!=null&&supplierData.attachmentReports.length>0\n            &&attachNameList.length==0){            \n              supplierData.attachmentReports.forEach((attachmentStatistics) => {\n              let attachmentName = attachmentStatistics.attachmentName.slice(\n                  attachmentStatistics.attachmentName.lastIndexOf(\"/\") + 1\n              );\n\n              attachNameList.push(\n                this.buildHeaderBean(\n                  \"已下载统计(\" + attachmentName + \")\",\n                  attachmentStatistics.attachmentName\n                )\n              );\n            });          \n          }\n      });        \n      \n      attachNameList.forEach((headerBean)=>{\n          headerDataArray.push(headerBean);\n      });\n      \n      return headerDataArray;\n    },\n\n    /**\n     * 阅读统计赋值\n     */\n    composeReadStatisticsData(bodyBean,haveReadCount,readCount){\n          if(this.selectReadValue == this.STATUS_READ){\n              bodyBean.readingStatisticsCount = haveReadCount;\n          }else{\n              bodyBean.readingStatisticsCount = readCount - haveReadCount;\n          }          \n          bodyBean.readingTotalCount = readCount;\n          bodyBean.readingPercentage = roundFun(bodyBean.readingStatisticsCount,bodyBean.readingTotalCount);        \n    },\n\n    /**\n     * 阅读统计反馈\n     */\n    composeFeedbackData(bodyBean,haveFeedbackCount,feedbackCount){      \n          bodyBean.replyStatisticsCount = haveFeedbackCount;            \n          bodyBean.replyTotalCount = feedbackCount;\n          bodyBean.replyPercentage = roundFun(bodyBean.replyStatisticsCount,bodyBean.replyTotalCount);\n    },\n\n    /**\n     * 组装附件文件\n     */\n    composeAttachFile(attachmentStatistics){\n        let attachData = {};\n        \n        attachData.attachmentId = attachmentStatistics.attachmentId;\n        attachData.valueStatisticsCount = attachmentStatistics.haveDownloadCount;        \n        attachData.valueTotalCount = attachmentStatistics.downloadCount;\n        attachData.valuePercentage = roundFun(attachData.valueStatisticsCount,attachData.valueTotalCount);\n\n        return attachData;\n    },\n\n    /**\n     * 新建一个附件对象\n     */\n    buildNewAttachmentData(){\n        return {\n            id: \"\",\n            statisticsCount: 0,\n            totalCount: 0,          \n        };\n    },\n   \n    /**\n     * 组装表格内容\n     */\n    initBodyData(data) {\n        let dataArray = [];\n        let totalinfo = {};\n        let totalAttachmentStatistics = [];\n\n        totalinfo.area = \"合计\";\n\n        let readStatisticsCount = 0,\n          readStatisticsTotalCount = 0;\n        let feedbackStatisticsCount = 0,\n          feedbackStatisticsTotalCount = 0;\n\n        data.forEach((statisticsReport) => {\n\n              if(statisticsReport.area==null){ \n                return;                     \n              }\n\n              let bodyBean = {};\n\n              bodyBean.area = statisticsReport.area;\n\n              //阅读统计赋值\n              this.composeReadStatisticsData(bodyBean,statisticsReport.haveReadCount,statisticsReport.readCount);\n              readStatisticsCount += bodyBean.readingStatisticsCount;\n              readStatisticsTotalCount += bodyBean.readingTotalCount;\n\n              //回复统计赋值\n              this.composeFeedbackData(bodyBean,statisticsReport.haveFeedbackCount,statisticsReport.feedbackCount);\n              feedbackStatisticsCount += bodyBean.replyStatisticsCount;\n              feedbackStatisticsTotalCount += bodyBean.replyTotalCount;   \n\n              //附件下载统计\n              let attachDataList = [];\n\n              statisticsReport.attachmentReports.forEach(\n                (attachmentStatistics, index) => {            \n\n                  if (totalAttachmentStatistics[index] == undefined) {\n                      totalAttachmentStatistics[index] = this.buildNewAttachmentData();\n                  }\n\n                  //设置附件数据\n                  let attachData = this.composeAttachFile(attachmentStatistics);\n                  \n                  totalAttachmentStatistics[index].attachmentId = attachmentStatistics.attachmentId;\n                  totalAttachmentStatistics[index].statisticsCount += attachData.valueStatisticsCount;\n                  totalAttachmentStatistics[index].totalCount += attachData.valueTotalCount;\n\n                  attachDataList.push(attachData);\n                }\n              );\n\n              bodyBean.attachDataList = attachDataList;\n\n              dataArray.push(bodyBean);\n            });\n\n            totalinfo.readingStatisticsCount = readStatisticsCount;\n            totalinfo.readingTotalCount = readStatisticsTotalCount;\n            totalinfo.readingPercentage = roundFun(readStatisticsCount,readStatisticsTotalCount);\n\n            totalinfo.replyStatisticsCount = feedbackStatisticsCount;\n            totalinfo.replyTotalCount = feedbackStatisticsTotalCount;\n            totalinfo.replyPercentage = roundFun(feedbackStatisticsCount,feedbackStatisticsTotalCount);\n\n            totalinfo.attachDataList = [];\n            totalAttachmentStatistics.forEach((attachmentStatistics) => {\n              let attachData = {};\n\n            attachData.attachmentId = attachmentStatistics.attachmentId;\n            attachData.valueStatisticsCount = attachmentStatistics.statisticsCount;\n            attachData.valueTotalCount = attachmentStatistics.totalCount;\n            attachData.valuePercentage = roundFun(attachmentStatistics.statisticsCount,attachmentStatistics.totalCount);\n\n            totalinfo.attachDataList.push(attachData);\n        });\n\n        console.log(\n          \"totalAttachmentStatistics:\" + JSON.stringify(totalinfo.attachDataList)\n        );\n\n        dataArray.unshift(totalinfo);\n\n        return dataArray;\n    },    \n\n    closeReminder() {\n      console.log(\"......关闭提醒按钮.......\");\n      this.remindDialog = false;\n      closeSnackbar();\n    },\n\n    //关闭\n    bt_close() {\n      console.log(\"......关闭按钮.......\");\n      this.$emit(\"closedChild\", false);\n    },\n    //关闭dialog\n    closeParent(unSelectComanyInfoMapInfo) {\n      console.log(\"-----------\" + this.nowDialog);\n      this.dialog_supplier = false;\n\n      this.unSelectComanyInfoMapInfo.clear();\n      for (let [key, value] of unSelectComanyInfoMapInfo.entries()) {\n        this.unSelectComanyInfoMapInfo.set(key, value);\n      }\n    },\n\n    /**\n     * 获取需要排除的公司列表\n     */\n    getUnSelectCompanyCodeList(){\n        let excludeCompanyCode = [];\n\n        for (let [key, value] of this.unSelectComanyInfoMapInfo.entries()) {\n            if(value.length==0){              \n                excludeCompanyCode.push(key);\n            }\n        }\n\n        console.log('getUnSelectCompanyCodeList:'+JSON.stringify(excludeCompanyCode));\n\n        return excludeCompanyCode;      \n    },\n\n    /**\n     * 获取需要排除的用户列表\n     */\n    getUnselectUserList(){\n        let excludeUserList = [];\n\n        for (let [key, value] of this.unSelectComanyInfoMapInfo.entries()) {\n            console.log(\"key:\"+key+\" value:\"+JSON.stringify(value));\n            if(value.length>0){       \n                value.forEach((item)=>{\n                  excludeUserList.push(item);\n                });                       \n            }\n        }\n\n        console.log('getUnselectUserList:'+JSON.stringify(excludeUserList));\n\n        return excludeUserList;\n    },  \n\n    //显示Reminder弹出框\n    showReminderDialog(){\n        this.remindDialog = true;\n        this.reminderLoading = true;\n\n        getReminderDealers(this.msgID,this.getUnSelectCompanyCodeList())\n        .then((res) => {            \n            if(res.code=='0'){\n                this.reminderCompanyList = res.data;\n            }else{\n                this.reminderCompanyList = [];\n            }            \n            console.log('reminderCompanyList:'+JSON.stringify(this.reminderCompanyList));\n        }).finally(()=>{\n          this.reminderLoading = false;\n        });\n\n    },\n    //发送提醒\n    sendReminder() {\n      console.log(\"......发送提醒.......\");\n\n      this.isSending = true;\n      this.remindDialog = false;      \n\n      sendMessageRemind(\n        this.msgID,\n        this.getUnSelectCompanyCodeList(),\n        this.getUnselectUserList()\n        )\n        .then((res) => {\n            if(res.code==0){\n              showSnackbar(\"发送成功\");          \n            }\n        })\n        .catch((error) => {\n          console.log(error);\n          if (error.response == null || typeof error.response == \"undefined\") {\n            return;\n          }\n          let res = error.response;\n          if (res.data == null || typeof res.data == \"undefined\") {\n            return;\n          }\n          let data = res.data;\n          if (\n            data.code != null &&data.code=='28'\n          ) {\n            showSnackbar(\"1小时内只能发送1次提醒，请稍后再试试\");            \n          }\n\n        }).finally(()=>{            \n            this.isSending = false;\n        });\n    },\n    //查找\n    bt_search() {\n      console.log(\"......查找.......:\" + this.search_sele);\n      if (this.search_sele != \"\") {\n          this.getDealerReportService();\n      }\n    },\n    //还原\n    bt_reset() {\n      console.log(\"......还原.......\");\n      this.search_sele = \"\";\n      (this.select_status = \"未读\"),\n        (this.select_type = { text: \"全部\", id: \"\" });\n      this.selectReadValue = this.STATUS_UNREAD;\n      this.select_area = \"全部\";\n\n      this.getDealerReportService();\n    },\n    //状态选择的值改变\n    selectStatusChange() {\n      console.log(\"....状态选择.... :\" + this.select_status);\n      if (this.select_status == \"未读\") {\n        this.selectReadValue = this.STATUS_UNREAD;\n      } else {\n        this.selectReadValue = this.STATUS_READ;\n      }\n\n      this.getDealerReportService();\n    },\n    //区域选择的值改变\n    selectAreaChange() {\n      console.log(\"....区域选择.... :\" + this.select_area);\n\n      this.getDealerReportService();\n    },\n    exportReply() {\n      console.log(\"....导出回复附件.... :\" + this.select_area);\n\n      let currentTime = Math.round(+new Date() / 1000);\n\n      //文字回复\n      if (this.feebackBackType == 2) {\n        downloadReplyReport(this.msgID, \"回复内容_\" + currentTime + \".zip\");\n      }else{//附件回复\n        downloadReplyReport(this.msgID, \"回复内容_\" + currentTime + \".xls\");\n      }\n    },\n    //类型选择的值改变\n    selectTypeChange() {\n      this.selectTypeValue = this.select_type.id;\n\n      console.log(\"....类型选择.... selectTypeValue:\" + this.selectTypeValue);\n\n      this.getDealerReportService();\n    },\n    //当table row click时触发\n    clickRow: function (type, area, attachId) {    \n      if(area=='合计'){        \n        //  this.clickAreaName = this.getQueryArea('全部');\n        return;\n      } else{\n         this.clickAreaName = this.getQueryArea(area);\n      }\n      this.statisticsStatus = type;\n      this.attachmentId = attachId;\n\n      console.log(\n        \"....rowClick.... statisticsStatus:\" +\n          this.statisticsStatus +\n          \"  clickAreaName:\" +\n          JSON.stringify(this.clickAreaName) +\n          \" attachmentId:\" +\n          this.attachmentId\n      );\n\n      this.dialog_supplier = true;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n</style>"]}]}
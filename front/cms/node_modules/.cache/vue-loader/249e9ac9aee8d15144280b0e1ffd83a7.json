{"remainingRequest":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuguanghui/Documents/cms_code/my-message/cms/src/views/page/publishArticle/timePicker.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/src/views/page/publishArticle/timePicker.vue","mtime":1638263637160},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBtb2RlbDogewogICAgcHJvcDogInRpbWUiLAogICAgZXZlbnQ6ICJjaGFuZ2UiLAogIH0sCiAgcHJvcHM6IHsKICAgIHRpbWU6IHsKICAgICAgdHlwZTogW1N0cmluZywgT2JqZWN0XSwKICAgICAgZGVmYXVsdDogIiIsCiAgICB9LAogICAgbWluVGltZTogewogICAgICB0eXBlOiBbRGF0ZSwgU3RyaW5nXSwKICAgICAgZGVmYXVsdDogIiIsCiAgICB9LAogICAgbWF4VGltZTogewogICAgICB0eXBlOiBbRGF0ZSwgU3RyaW5nXSwKICAgICAgZGVmYXVsdDogIiIsCiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNob3dUaW1lUGlja2VyOiBmYWxzZSwKICAgICAgc2hvd0RhdGVQaWNrZXI6IGZhbHNlLAogICAgICBzZWxlY3REYXRlOiAiIiwKICAgICAgc2VsZWN0VGltZTogIiIsCiAgICAgIG1heFRpbWVSdWxlOiBudWxsLAogICAgICBtaW5UaW1lUnVsZTogbnVsbCwKICAgIH07CiAgfSwKICB3YXRjaDoge30sCgogIG1ldGhvZHM6IHsKICAgIHNldFRpbWUoKSB7CiAgICAgIGxldCB0aW1lID0gdGhpcy5zZWxlY3REYXRlICsgIiAiICsgdGhpcy5zZWxlY3RUaW1lOwogICAgICBpZiAodGhpcy5zZWxlY3RUaW1lICE9ICIiKSB7CiAgICAgICAgdGltZSArPSAiOjAwIjsKICAgICAgfQogICAgICB0aGlzLiRlbWl0KCJjaGFuZ2UiLCB0aW1lKTsKICAgIH0sCgogICAgc2V0VGltZVJ1bGUoKSB7CiAgICAgIGlmICh0aGlzLmlzVmFsaWREYXRlKHRoaXMubWluVGltZSkpIHsKICAgICAgICBpZiAobmV3IERhdGUodGhpcy5zZWxlY3REYXRlKS5nZXRUaW1lKCkgPCB0aGlzLm1pblRpbWUuZ2V0VGltZSgpKSB7CiAgICAgICAgICB0aGlzLm1pblRpbWVSdWxlID0gdGhpcy5taW5UaW1lLmZvcm1hdCgiaGg6bW0iKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5tYXhUaW1lUnVsZSA9IG51bGw7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtaW52YWwgPSBuZXcgRGF0ZSh0aGlzLm1pblRpbWUpOwogICAgICAgIGlmICh0aGlzLmlzVmFsaWREYXRlKG1pbnZhbCkpIHsKICAgICAgICAgIGlmIChuZXcgRGF0ZSh0aGlzLnNlbGVjdERhdGUpLmdldFRpbWUoKSA8IG1pbnZhbC5nZXRUaW1lKCkrIDggKiA2MCAqIDYwICogMTAwMCkgewogICAgICAgICAgICB0aGlzLm1pblRpbWVSdWxlID0gbWludmFsLmZvcm1hdCgiaGg6bW0iKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMubWF4VGltZVJ1bGUgPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNWYWxpZERhdGUodGhpcy5tYXhUaW1lKSkgewogICAgICAgIGlmIChuZXcgRGF0ZSh0aGlzLnNlbGVjdERhdGUpLmdldFRpbWUoKSA+IHRoaXMubWF4VGltZS5nZXRUaW1lKCkpIHsKICAgICAgICAgIHRoaXMubWF4VGltZVJ1bGUgPSB0aGlzLm1heFRpbWUuZm9ybWF0KCJoaDptbSIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm1heFRpbWVSdWxlID0gbnVsbDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIG1heHZhbCA9IG5ldyBEYXRlKHRoaXMubWF4VGltZSk7CiAgICAgICAgaWYgKHRoaXMuaXNWYWxpZERhdGUobWF4dmFsKSkgewogICAgICAgICAgaWYgKAogICAgICAgICAgICBuZXcgRGF0ZSh0aGlzLnNlbGVjdERhdGUpLmdldFRpbWUoKSA+CiAgICAgICAgICAgIG1heHZhbC5nZXRUaW1lKCkgLSAxNiAqIDYwICogNjAgKiAxMDAwCiAgICAgICAgICApIHsKICAgICAgICAgICAgdGhpcy5tYXhUaW1lUnVsZSA9IG1heHZhbC5mb3JtYXQoImhoOm1tIik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLm1heFRpbWVSdWxlID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBpc1ZhbGlkRGF0ZShkYXRlKSB7CiAgICAgIHJldHVybiBkYXRlIGluc3RhbmNlb2YgRGF0ZSAmJiAhaXNOYU4oZGF0ZS5nZXRUaW1lKCkpOwogICAgfSwKICAgIGFsbG93ZWRfZGF0ZXModmFsKSB7CiAgICAgIHZhciByZXMgPSB0cnVlOwogICAgICBpZiAodGhpcy5pc1ZhbGlkRGF0ZSh0aGlzLm1pblRpbWUpKSB7CiAgICAgICAgcmVzID0KICAgICAgICAgIG5ldyBEYXRlKHZhbCkuZ2V0VGltZSgpID4KICAgICAgICAgIHRoaXMubWluVGltZS5nZXRUaW1lKCkgLSAxNiAqIDYwICogNjAgKiAxMDAwOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtaW4gPSBuZXcgRGF0ZSh0aGlzLm1pblRpbWUpOwogICAgICAgIGlmICh0aGlzLmlzVmFsaWREYXRlKG1pbikpIHsKICAgICAgICAgIHJlcyA9IG5ldyBEYXRlKHZhbCkuZ2V0VGltZSgpID4gbWluLmdldFRpbWUoKSAtIDE2ICogNjAgKiA2MCAqIDEwMDA7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5pc1ZhbGlkRGF0ZSh0aGlzLm1heFRpbWUpKSB7CiAgICAgICAgY29uc29sZS5sb2cobmV3IERhdGUodmFsKS5nZXRUaW1lKCkgLSB0aGlzLm1heFRpbWUuZ2V0VGltZSgpKTsKICAgICAgICByZXMgPSByZXMgJiYgbmV3IERhdGUodmFsKS5nZXRUaW1lKCkgPCB0aGlzLm1heFRpbWUuZ2V0VGltZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBtYXggPSBuZXcgRGF0ZSh0aGlzLm1heFRpbWUpOwogICAgICAgIGlmICh0aGlzLmlzVmFsaWREYXRlKG1heCkpIHsKICAgICAgICAgIHJlcyA9CiAgICAgICAgICAgIHJlcyAmJiBuZXcgRGF0ZSh2YWwpLmdldFRpbWUoKSA8IG1heC5nZXRUaW1lKCkgKyA4ICogNjAgKiA2MCAqIDEwMDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXM7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["timePicker.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"timePicker.vue","sourceRoot":"src/views/page/publishArticle","sourcesContent":["<template>\n  <v-menu\n    ref=\"menu1\"\n    :close-on-content-click=\"false\"\n    transition=\"scale-transition\"\n    offset-y\n    v-model=\"showDatePicker\"\n    min-width=\"auto\"\n  >\n    <template v-slot:activator=\"{ on, attrs }\">\n      <div v-bind=\"attrs\" v-on=\"on\" style=\"display: inline-block\">\n        <slot></slot>\n      </div>\n    </template>\n\n    <v-date-picker\n      v-model=\"selectDate\"\n      scrollable\n      no-title\n      :allowed-dates=\"allowed_dates\"\n      v-if=\"showDatePicker && !showTimePicker\"\n      @change=\"\n        showTimePicker = true;\n        setTimeRule();\n        setTime();\n      \"\n    >\n      <v-spacer></v-spacer>\n    </v-date-picker>\n    <v-time-picker\n      format=\"24hr\"\n      no-title\n      v-model=\"selectTime\"\n      v-if=\"showTimePicker\"\n      :max=\"maxTimeRule\"\n      :min=\"minTimeRule\"\n      click:hour=\"setTime()\"\n      @change=\"\n        showTimePicker = false;\n        showDatePicker = false;\n        setTime();\n      \"\n    ></v-time-picker>\n  </v-menu>\n</template>\n<script>\nexport default {\n  model: {\n    prop: \"time\",\n    event: \"change\",\n  },\n  props: {\n    time: {\n      type: [String, Object],\n      default: \"\",\n    },\n    minTime: {\n      type: [Date, String],\n      default: \"\",\n    },\n    maxTime: {\n      type: [Date, String],\n      default: \"\",\n    },\n  },\n  data() {\n    return {\n      showTimePicker: false,\n      showDatePicker: false,\n      selectDate: \"\",\n      selectTime: \"\",\n      maxTimeRule: null,\n      minTimeRule: null,\n    };\n  },\n  watch: {},\n\n  methods: {\n    setTime() {\n      let time = this.selectDate + \" \" + this.selectTime;\n      if (this.selectTime != \"\") {\n        time += \":00\";\n      }\n      this.$emit(\"change\", time);\n    },\n\n    setTimeRule() {\n      if (this.isValidDate(this.minTime)) {\n        if (new Date(this.selectDate).getTime() < this.minTime.getTime()) {\n          this.minTimeRule = this.minTime.format(\"hh:mm\");\n        } else {\n          this.maxTimeRule = null;\n        }\n      } else {\n        var minval = new Date(this.minTime);\n        if (this.isValidDate(minval)) {\n          if (new Date(this.selectDate).getTime() < minval.getTime()+ 8 * 60 * 60 * 1000) {\n            this.minTimeRule = minval.format(\"hh:mm\");\n          } else {\n            this.maxTimeRule = null;\n          }\n        }\n      }\n\n      if (this.isValidDate(this.maxTime)) {\n        if (new Date(this.selectDate).getTime() > this.maxTime.getTime()) {\n          this.maxTimeRule = this.maxTime.format(\"hh:mm\");\n        } else {\n          this.maxTimeRule = null;\n        }\n      } else {\n        var maxval = new Date(this.maxTime);\n        if (this.isValidDate(maxval)) {\n          if (\n            new Date(this.selectDate).getTime() >\n            maxval.getTime() - 16 * 60 * 60 * 1000\n          ) {\n            this.maxTimeRule = maxval.format(\"hh:mm\");\n          } else {\n            this.maxTimeRule = null;\n          }\n        }\n      }\n    },\n    isValidDate(date) {\n      return date instanceof Date && !isNaN(date.getTime());\n    },\n    allowed_dates(val) {\n      var res = true;\n      if (this.isValidDate(this.minTime)) {\n        res =\n          new Date(val).getTime() >\n          this.minTime.getTime() - 16 * 60 * 60 * 1000;\n      } else {\n        var min = new Date(this.minTime);\n        if (this.isValidDate(min)) {\n          res = new Date(val).getTime() > min.getTime() - 16 * 60 * 60 * 1000;\n        }\n      }\n\n      if (this.isValidDate(this.maxTime)) {\n        console.log(new Date(val).getTime() - this.maxTime.getTime());\n        res = res && new Date(val).getTime() < this.maxTime.getTime();\n      } else {\n        var max = new Date(this.maxTime);\n        if (this.isValidDate(max)) {\n          res =\n            res && new Date(val).getTime() < max.getTime() + 8 * 60 * 60 * 1000;\n        }\n      }\n      return res;\n    },\n  },\n};\n</script>"]}]}
{"remainingRequest":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuguanghui/Documents/cms_code/my-message/cms/src/views/page/authorityManagement.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/src/views/page/authorityManagement.vue","mtime":1653680117599},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liuguanghui/Documents/cms_code/my-message/cms/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldFRlbXBsYXRlTGlzdCxnZXREZXB0TGlzdEJ5QWRtaW4sZGVsZXRlVGVtcGxhdGUgfSBmcm9tICJAL2FwaS9nZXREYXRhIjsKaW1wb3J0ICJAL3V0aWxzL3RpbWVGb3JtYXRlLmpzIjsKaW1wb3J0IHt0cmFuc2Zvcm1hdGlvbkF1dGhvcml0eX0gZnJvbSAiQC91dGlscy90ZW1wbGF0ZVV0aWxzLmpzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJhdXRob3JpdHlNYW5hZ2VtZW50IiwKICBjb21wb25lbnRzOiB7CiAgICBlZGl0QXV0aG9yaXR5OiAoKSA9PiBpbXBvcnQoIi4vZWRpdEF1dGhvcml0eSIpLAogICAgZGVsZGlhbG9nOiAoKSA9PiBpbXBvcnQoIkAvY29tcG9uZW50cy9iYXNlL2RlbGV0ZS52dWUiKSwKICB9LAoKICBtb3VudGVkKCkgewogICAgdGhpcy5sb2FkaW5nRGF0YSA9IHRydWU7CiAgICBnZXRUZW1wbGF0ZUxpc3QoKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICB0aGlzLmxvYWRpbmdEYXRhID0gZmFsc2U7CiAgICAgIGNvbnNvbGUubG9nKCIjIyMjIyMjIyB0cmVtcGxhdGUgPT09PT09PT09PiAjIyMjIyMjICIgKyBKU09OLnN0cmluZ2lmeShyZXNwb25zZSkpOwogICAgICAgIGlmKHJlc3BvbnNlLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy50ZW1wbGF0ZUxpc3QgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgLy/miormnYPpmZDlrZfmrrXnmoRtZW51TmFtZeWQjeWtl+aNouaIkG5hbWUKICAgICAgICAgICB0aGlzLnRlbXBsYXRlTGlzdC5mb3JFYWNoKHRlbXAgPT4gewogICAgICAgICAgICAgaWYodGVtcCAhPT0gbnVsbCAmJiB0eXBlb2YgdGVtcCAhPT0gInVuZGVmaW5lZCIpIHsgICAKICAgICAgICAgICAgICAgdGVtcC50aW1lID0gbmV3IERhdGUodGVtcC5jcmVhdGVfdGltZSkuZm9ybWF0KCJ5eXl5LU1NLWRkIGhoOm1tOnNzIikgCiAgICAgICAgICAgICAgIHRyYW5zZm9ybWF0aW9uQXV0aG9yaXR5KHRlbXAudGFyZ2V0TGlzdCkKICAgICAgICAgICAgIH0gICAgCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pLmNhdGNoKChlKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nRGF0YSA9IGZhbHNlOwogICAgICAgIGNvbnNvbGUubG9nKCJvbiBsb2FkIGF1dGhvcml0eSBlcnJvciA9PT0+IitlKQogICAgICB9KTsKICAgIAogICAgLy/ku47nvZHnu5zojrflj5bpg6jpl6gKICAgICBnZXREZXB0TGlzdEJ5QWRtaW4oKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCIjIyMjIyMjIyBkZXBhcnRtZW50IGxpc3QgPT09PT09PT09PiAjIyMjIyMjICIgKyBKU09OLnN0cmluZ2lmeShyZXNwb25zZSkpOwogICAgICAgICBpZihyZXNwb25zZS5kYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICB0aGlzLmRlcGFydG1lbnQgPSByZXNwb25zZS5kYXRhCiAgICAgICAgICB9CiAgICAgIH0pLmNhdGNoKCk7CgogICAgLy90aGlzLmRlcGFydG1lbnQgPSBnZXREZXB0TGlzdCgpIAogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhbGVydDpmYWxzZSwKICAgICAgYWxlcnRNZXNzYWdlOiIiLAogICAgICBhZGRTdWNjZXNzVGV4dDoi5re75Yqg5qih5p2/5oiQ5YqfIiwKICAgICAgdXBkYXRlU3VjY2Vzc1RleHQ6IuabtOaWsOaooeadv+aIkOWKnyIsCiAgICAgIGRlbGV0ZVN1Y2Nlc3NUZXh0OiLliKDpmaTmqKHmnb/miJDlip8iLAogICAgICBkZWxldGVTdWNjZXNzRmFpbGVkVGV4dDoi5Yig6Zmk5qih5p2/5aSx6LSlLOivt+eojeWQjuWGjeivlS4uLiIsCiAgICAgIGNhdXRpb25UZXh0OiIiLAogICAgICB0aW1lb3V0OjMwMDAsCiAgICAgIGNhdXRpb246ZmFsc2UsCiAgICAgIGRpYWxvZzogZmFsc2UsCiAgICAgIGRpYWxvZ0RlbGV0ZTogZmFsc2UsCiAgICAgIGVkaXRBdXRob3JpdHk6IGZhbHNlLAogICAgICBzdWJtaXRpbmc6ZmFsc2UsCiAgICAgIGxvYWRpbmdEYXRhOmZhbHNlLAogICAgICBoZWFkZXJzOiBbCiAgICAgICAgewogICAgICAgICAgdGV4dDogIuadg+mZkOWQjeensCIsCiAgICAgICAgICBhbGlnbjogInN0YXJ0IiwKICAgICAgICAgIHdpZHRoOiAiMjQwIiwKICAgICAgICAgIHZhbHVlOiAidGVtcGxhdGVOYW1lIiwKICAgICAgICB9LAogICAgICAgIHsgdGV4dDogIuadg+mZkOaPj+i/sCIsd2lkdGg6ICIzMDAiLGFsaWduOiAic3RhcnQiLHZhbHVlOiAiZGVzYyIgfSwKICAgICAgICAvLyB7IHRleHQ6ICfljIXlkKvmnYPpmZAnLCB2YWx1ZTogJ2F1dGhvcml0eScgfSwKICAgICAgICB7IHRleHQ6ICLljIXlkKvpg6jpl6giLCBhbGlnbjogInN0YXJ0IiwgdmFsdWU6ICJvZW1MaXN0IiB9LAogICAgICAgIHsgdGV4dDogIuWPkeW4g+aXtumXtCIsd2lkdGg6ICIxODAiLCBzb3J0YWJsZTogZmFsc2UsIHZhbHVlOiAidGltZSIgfSwKICAgICAgICB7IHRleHQ6ICLmk43kvZwiLCB3aWR0aDogIjkwIix2YWx1ZTogImFjdGlvbnMiLCBzb3J0YWJsZTogdHJ1ZSB9LAogICAgICBdLAoKICAgICAgdGVtcGxhdGVMaXN0OiBbXSwKICAgICAgdGVtcGxhdGU6e30sCiAgICAgIGRlcGFydG1lbnQ6W10sCiAgICAgIC8vPT09PT09ICDliIblibLnur89PT09PT09CiAgICAgIGVkaXRlZEluZGV4OiAtMSwKICAgICAgZWRpdGVkSXRlbTogewogICAgICAgIG5hbWU6ICIiLAogICAgICAgIGRlc2NyaXB0aW9uOiAiIiwKICAgICAgICBhdXRob3JpdHk6IFtdLAogICAgICAgIHJvbGVzOiAiIiwKICAgICAgfSwKICAgICAgc2VsZWN0aW9uOiBbXSwKICAgIH07CiAgfSwKCiAgLy/liqDovb3pobXpnaLml7borr7nva7mt7vliqDlkoznvJbovpHmoIfpopgKICBjb21wdXRlZDogewoKICB9LAoKICAvL+ebkeinhuWvueivneahhgogIHdhdGNoOiB7CiAgICBlZGl0QXV0aG9yaXR5KCkgewogICAgICAvL+e8lui+keWvueivneahhuW3suWFs+mXreOAgua4heeQhuaVsOaNrgogICAgICBpZih0aGlzLmVkaXRBdXRob3JpdHkgPT09IGZhbHNlKSB7CiAgICAgICAgLy/muIXnkIbotYTmupDjgIIKICAgICAgICAgIHRoaXMudGVtcGxhdGUgPSB7fQogICAgICAgICAgLy8gYWxlcnQoInJlc3VsdCA9ICIrcmVzdWx0KyIgdiAiK3YgKyAiICAiK2gpCiAgICAgIH0KICAgIH0sCiAgfSwKCiAgLy/pobXpnaLnrKzkuIDmrKHliqDovb3ml7Ys6LCD55So5Yid5aeL5YyW5pa55rOVCiAgY3JlYXRlZCgpIHsKICAgIAogIH0sCgogIG1ldGhvZHM6IHsKICAgIGxlbmdodGgodGV4dCwgbGVuZ3RoLCBzdWZmaXggPSAiLi4uIikgewogICAgICBpZiAoIXRleHQpIHJldHVybjsKICAgICAgaWYgKHRleHQubGVuZ3RoIDw9IGxlbmd0aCkgewogICAgICAgIHJldHVybiB0ZXh0OwogICAgICB9CiAgICAgIHJldHVybiAodGV4dCArICIiKS5zdWJzdHJpbmcoMCwgbGVuZ3RoKSArIHN1ZmZpeDsKICAgIH0sCgogICAgbm90aWZpeVVzZXIoaXRlbSkgewogICAgICB0aGlzLiRyZWZzLmRlbGRpYWxvZy5jb25maXJtKCLnoa7lrprliKDpmaTmraTmqKHmnb/lkJc/IikKICAgICAgICAudGhlbigoKSA9PiB0aGlzLm9uRGVsZXRlVGVtcGxhdGUoaXRlbSkpCiAgICAgICAgLmNhdGNoKCgpID0+IHt9KTsgICAgICAKICAgIH0sCiAgICAKICAgIG9uRGVsZXRlVGVtcGxhdGUoaXRlbSkgewogICAgICB0aGlzLnN1Ym1pdGluZyA9IHRydWU7CiAgICAgIGRlbGV0ZVRlbXBsYXRlKGl0ZW0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgdGhpcy5zdWJtaXRpbmcgPSBmYWxzZTsKICAgICAgICBjb25zb2xlLmxvZygiZGVsZXRlIHRlbXBsYXRlIHJlc3VsdCA9PT4gIiArIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7CiAgICAgICAgaWYocmVzcG9uc2UgIT0gbnVsbCAmJiB0eXBlb2YgcmVzcG9uc2UuY29kZSAhPT0gInVuZGVmaW5lZCIgJiYgcmVzcG9uc2UuY29kZSA9PT0gMCkgewogICAgICAgICAgdGhpcy5kZWxldGVJdGVtKGl0ZW0udGVtcGxhdGVJZCkKICAgICAgICAgIHRoaXMuYWxlcnQgPSB0cnVlOwogICAgICAgICAgdGhpcy5hbGVydE1lc3NhZ2UgPSB0aGlzLmRlbGV0ZVN1Y2Nlc3NUZXh0OwogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5hbGVydCA9IGZhbHNlIH0sIDE1MDApOwogICAgICAgIH1lbHNlIHsKICAgICAgICB0aGlzLnN1Ym1pdGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuY2F1dGlvblRleHQgPSB0aGlzLmRlbGV0ZVN1Y2Nlc3NGYWlsZWRUZXh0OwogICAgICAgIHRoaXMuY2F1dGlvbiA9IHRydWU7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlID0+IHsKICAgICAgICBjb25zb2xlLmxvZygib24gZGVsZXRlIGVycm9yICIrZSkKICAgICAgICB0aGlzLnN1Ym1pdGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuY2F1dGlvblRleHQgPSB0aGlzLmRlbGV0ZVN1Y2Nlc3NGYWlsZWRUZXh0OwogICAgICAgIHRoaXMuY2F1dGlvbiA9IHRydWU7CiAgICAgIH0pOwogICAgfSwKCiAgICAvL+e8lui+keadg+mZkAogICAgZWRpdEl0ZW0oaXRlbSkgewogICAgICB0aGlzLnRlbXBsYXRlID0gaXRlbTsKICAgICAgdGhpcy5lZGl0QXV0aG9yaXR5PXRydWU7IAogICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShpdGVtKSkKICAgIH0sCgogICAgb25FZGl0QXV0aG9yaXR5VGVtcGxhdGVSZXN1bHQocmVzdWx0LHR5cGUpeyAgIAogICAgICBpZih0eXBlID09PSAiYWRkIikgewogICAgICAgIHJlc3VsdC5vZW1MaXN0ID0gcmVzdWx0Lm9lbUxpc3QuZmlsdGVyKHYgPT4gdiAhPT0gbnVsbCkKICAgICAgICByZXN1bHQudGFyZ2V0TGlzdCA9IHJlc3VsdC50YXJnZXRMaXN0LmZpbHRlcih2ID0+IHYgIT09IG51bGwpCiAgICAgICAgICAgICB0aGlzLnRlbXBsYXRlTGlzdC51bnNoaWZ0KHJlc3VsdCkKICAgICAgfWVsc2UgaWYodHlwZSA9PT0gInVwZGF0ZSIpIHsKICAgICAgICAvLzEu5om+5Yiw5pWw57uE6YeM6L+Z5Liq5YWD57SgCiAgICAgICAgLy8yLuWIoOmZpOi/meS4quWFg+e0oAogICAgICAgIC8vMy7lnKjmiormlrDnmoTmlbDmja7mj5LlhaUKICAgICAgICAvLyDmnInmm7Tlpb3nmoRqYXZhc2NyaXB05pa55rOV5ZCX77yfCiAgICAgICAgbGV0IGRlbFN1Y2MgPSB0aGlzLmRlbGV0ZUl0ZW0ocmVzdWx0LnRlbXBsYXRlSWQpICAgICAgCiAgICAgICAgaWYoZGVsU3VjYykgewogICAgICAgICAgdGhpcy50ZW1wbGF0ZUxpc3QudW5zaGlmdChyZXN1bHQpCiAgICAgICAgfSAgICAgCiAgICAgIH0KICAgICAgdGhpcy5hbGVydE1lc3NhZ2UgPSB0eXBlID09PSAiYWRkIiA/IHRoaXMuYWRkU3VjY2Vzc1RleHQgOiB0aGlzLnVwZGF0ZVN1Y2Nlc3NUZXh0CiAgICAgIHRoaXMuYWxlcnQgPSB0cnVlOwogICAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLmFsZXJ0ID0gZmFsc2UgfSwgMTUwMCk7CiAgICB9LAoKICAgIGRlbGV0ZUl0ZW0odGFyZ2V0VGVtcGxhdGVJZCkgewogICAgICBjb25zb2xlLmxvZygiZGVsZXRlIGxvY2FsIHRlbXBsYXRlIElEIDogWyIrdGFyZ2V0VGVtcGxhdGVJZCsiXSIpCiAgICAgIGxldCBpbmRleCA9IHRoaXMudGVtcGxhdGVMaXN0LmZpbmRJbmRleCh2ID0+IHYudGVtcGxhdGVJZCA9PT0gdGFyZ2V0VGVtcGxhdGVJZCk7ICAgICAKICAgICAgLy8gZm9yKGxldCBpPTA7IGk8dGhpcy50ZW1wbGF0ZUxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgLy8gICB0aGlzLnRlbXBsYXRlTGlzdFtpXS50ZW1wbGF0ZUlkID09PSB0YXJnZXRUZW1wbGF0ZUlkOwogICAgICAvLyAgIGluZGV4ID0gaTsKICAgICAgLy8gICBicmVhazsKICAgICAgLy8gfQogICAgICAvL2FsZXJ0KCJmaW5uZCBpbmRleCBpcyAiK2luZGV4KQogICAgICBpZihpbmRleCAhPT0gLTEpIHsKICAgICAgICAgIHRoaXMudGVtcGxhdGVMaXN0LnNwbGljZShpbmRleCwxKQogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["authorityManagement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"authorityManagement.vue","sourceRoot":"src/views/page","sourcesContent":["<template>\n  <v-data-table\n    :loading=\"loadingData\"\n    calculate-widths=\"true\"\n    loading-text=\"加载模板中,请稍后...\"\n    :headers=\"headers\"\n    :items=\"templateList\"\n    class=\"elevation-1\"\n    :items-per-page=\"10\"\n    :footer-props=\"{\n      'items-per-page-text': '每页显示条数',\n      pageText: '{0}-{1} of {2}',\n      'items-per-page-all-text': 'all',\n    }\"\n  >\n    <template v-slot:top>\n      <v-toolbar flat>\n        <v-toolbar-title>权限管理</v-toolbar-title>\n        <v-btn\n          color=\"primary\"\n          dark\n          class=\"mb-1 ml-4\"\n          @click=\"editAuthority = true\"\n        >\n          创建新模板\n        </v-btn>\n        \n        <edit-authority\n          :open=\"editAuthority\"\n          :template=\"template\"\n          :department=\"department\"\n          @closeDialog=\"editAuthority = false\"\n          @onEditAuthorityTemplateResult=\"onEditAuthorityTemplateResult\"\n        />\n\n        <!-- 提交成功的alert -->    \n           <v-alert\n              :value=\"alert\"\n              :timeout=\"timeout\"\n              border=\"left\"\n              color=\"green\"\n              type=\"success\"\n              transition=\"scale-transition\"\n            >{{alertMessage}}</v-alert>\n            <v-spacer></v-spacer>\n        <!--删除dialog-->\n        <deldialog ref=\"deldialog\" />\n        <!-- 提示 -->\n        <v-snackbar\n            v-model=\"caution\"\n            :timeout=\"timeout\"\n            :centened=\"true\"\n            :width=\"240\"\n          >\n            {{cautionText}}\n\n            <template v-slot:action=\"{ attrs }\">\n              <v-btn color=\"blue\" text v-bind=\"attrs\" @click=\"caution = false\">\n                关闭\n              </v-btn>\n            </template>\n          </v-snackbar>\n\n        <!--提交进度-->\n        <v-dialog\n              v-model=\"submiting\"\n              persistent\n              width=\"300\"\n            >\n              <v-card\n                color=\"primary\"\n                dark\n              >\n                <v-card-text>\n                  删除权限中,请稍后...\n                  <v-progress-linear\n                    indeterminate\n                    color=\"white\"\n                    class=\"mb-0\"\n                  ></v-progress-linear>\n                </v-card-text>\n              </v-card>\n           </v-dialog>\n\n      </v-toolbar>\n    </template>\n\n    <template v-slot:[`item.templateName`]=\"{ item }\">\n       <v-tooltip bottom>\n        <template v-slot:activator=\"{ on, attrs }\">\n        <span  v-bind=\"attrs\"\n          v-on=\"on\"> {{lenghth(item.templateName,12)}} </span>\n        </template>\n        <span>{{item.templateName}}</span>\n         </v-tooltip>\n    </template>\n\n    <template v-slot:[`item.oemList`]=\"{ item }\">\n     \n        <v-chip\n          small\n          v-for=\"(dept, index) in item.oemList\"\n          class=\"ma-1\"\n          :key=\"index\"\n          color=\"primary\"\n          text-color=\"white\"\n        >\n          {{ dept.companyName}}\n        </v-chip>  \n    </template>\n\n    <template v-slot:[`item.actions`]=\"{ item }\">\n      <v-row>\n      <a style=\"color: #1867c0\"  class=\" mr-2\" @click=\"editItem(item)\" plain > 编辑 </a>  \n      <a style=\"color: #1867c0\" class=\" mr-4\" @click=\"notifiyUser(item)\"> 删除 </a>\n      </v-row>    \n      </template>\n    <template v-slot:no-data>\n      <v-subheader dense>还没有权限模板，请添加模板.</v-subheader>\n    </template>\n  </v-data-table>\n</template>\n\n<script>\nimport { getTemplateList,getDeptListByAdmin,deleteTemplate } from \"@/api/getData\";\nimport \"@/utils/timeFormate.js\";\nimport {transformationAuthority} from \"@/utils/templateUtils.js\";\nexport default {\n  name: \"authorityManagement\",\n  components: {\n    editAuthority: () => import(\"./editAuthority\"),\n    deldialog: () => import(\"@/components/base/delete.vue\"),\n  },\n\n  mounted() {\n    this.loadingData = true;\n    getTemplateList().then((response) => {\n      this.loadingData = false;\n      console.log(\"######## tremplate =========> ####### \" + JSON.stringify(response));\n        if(response.data.length > 0) {\n          this.templateList = response.data;\n          //把权限字段的menuName名字换成name\n           this.templateList.forEach(temp => {\n             if(temp !== null && typeof temp !== \"undefined\") {   \n               temp.time = new Date(temp.create_time).format(\"yyyy-MM-dd hh:mm:ss\") \n               transformationAuthority(temp.targetList)\n             }    \n          });\n        }\n      }).catch((e) => {\n        this.loadingData = false;\n        console.log(\"on load authority error ===>\"+e)\n      });\n    \n    //从网络获取部门\n     getDeptListByAdmin().then((response) => {\n        console.log(\"######## department list =========> ####### \" + JSON.stringify(response));\n         if(response.data.length > 0) {\n           this.department = response.data\n          }\n      }).catch();\n\n    //this.department = getDeptList() \n  },\n\n  data() {\n    return {\n      alert:false,\n      alertMessage:\"\",\n      addSuccessText:\"添加模板成功\",\n      updateSuccessText:\"更新模板成功\",\n      deleteSuccessText:\"删除模板成功\",\n      deleteSuccessFailedText:\"删除模板失败,请稍后再试...\",\n      cautionText:\"\",\n      timeout:3000,\n      caution:false,\n      dialog: false,\n      dialogDelete: false,\n      editAuthority: false,\n      submiting:false,\n      loadingData:false,\n      headers: [\n        {\n          text: \"权限名称\",\n          align: \"start\",\n          width: \"240\",\n          value: \"templateName\",\n        },\n        { text: \"权限描述\",width: \"300\",align: \"start\",value: \"desc\" },\n        // { text: '包含权限', value: 'authority' },\n        { text: \"包含部门\", align: \"start\", value: \"oemList\" },\n        { text: \"发布时间\",width: \"180\", sortable: false, value: \"time\" },\n        { text: \"操作\", width: \"90\",value: \"actions\", sortable: true },\n      ],\n\n      templateList: [],\n      template:{},\n      department:[],\n      //======  分割线=======\n      editedIndex: -1,\n      editedItem: {\n        name: \"\",\n        description: \"\",\n        authority: [],\n        roles: \"\",\n      },\n      selection: [],\n    };\n  },\n\n  //加载页面时设置添加和编辑标题\n  computed: {\n\n  },\n\n  //监视对话框\n  watch: {\n    editAuthority() {\n      //编辑对话框已关闭。清理数据\n      if(this.editAuthority === false) {\n        //清理资源。\n          this.template = {}\n          // alert(\"result = \"+result+\" v \"+v + \"  \"+h)\n      }\n    },\n  },\n\n  //页面第一次加载时,调用初始化方法\n  created() {\n    \n  },\n\n  methods: {\n    lenghth(text, length, suffix = \"...\") {\n      if (!text) return;\n      if (text.length <= length) {\n        return text;\n      }\n      return (text + \"\").substring(0, length) + suffix;\n    },\n\n    notifiyUser(item) {\n      this.$refs.deldialog.confirm(\"确定删除此模板吗?\")\n        .then(() => this.onDeleteTemplate(item))\n        .catch(() => {});      \n    },\n    \n    onDeleteTemplate(item) {\n      this.submiting = true;\n      deleteTemplate(item).then((response) => {\n        this.submiting = false;\n        console.log(\"delete template result ==> \" + JSON.stringify(response));\n        if(response != null && typeof response.code !== \"undefined\" && response.code === 0) {\n          this.deleteItem(item.templateId)\n          this.alert = true;\n          this.alertMessage = this.deleteSuccessText;\n          setTimeout(() => {this.alert = false }, 1500);\n        }else {\n        this.submiting = false;\n        this.cautionText = this.deleteSuccessFailedText;\n        this.caution = true;\n        }\n      }).catch(e => {\n        console.log(\"on delete error \"+e)\n        this.submiting = false;\n        this.cautionText = this.deleteSuccessFailedText;\n        this.caution = true;\n      });\n    },\n\n    //编辑权限\n    editItem(item) {\n      this.template = item;\n      this.editAuthority=true; \n      console.log(JSON.stringify(item))\n    },\n\n    onEditAuthorityTemplateResult(result,type){   \n      if(type === \"add\") {\n        result.oemList = result.oemList.filter(v => v !== null)\n        result.targetList = result.targetList.filter(v => v !== null)\n             this.templateList.unshift(result)\n      }else if(type === \"update\") {\n        //1.找到数组里这个元素\n        //2.删除这个元素\n        //3.在把新的数据插入\n        // 有更好的javascript方法吗？\n        let delSucc = this.deleteItem(result.templateId)      \n        if(delSucc) {\n          this.templateList.unshift(result)\n        }     \n      }\n      this.alertMessage = type === \"add\" ? this.addSuccessText : this.updateSuccessText\n      this.alert = true;\n      setTimeout(() => {this.alert = false }, 1500);\n    },\n\n    deleteItem(targetTemplateId) {\n      console.log(\"delete local template ID : [\"+targetTemplateId+\"]\")\n      let index = this.templateList.findIndex(v => v.templateId === targetTemplateId);     \n      // for(let i=0; i<this.templateList.length; i++) {\n      //   this.templateList[i].templateId === targetTemplateId;\n      //   index = i;\n      //   break;\n      // }\n      //alert(\"finnd index is \"+index)\n      if(index !== -1) {\n          this.templateList.splice(index,1)\n          return true;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n</style>"]}]}